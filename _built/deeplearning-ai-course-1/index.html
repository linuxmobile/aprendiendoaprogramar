<!doctype html><html domain=.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="" http-equiv=Content-Security-Policy><link href=/favicon.svg rel=icon type=image/svg+xml><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>DL 1 - NN and DL | Note of Thi</title><meta content="DL 1 - NN and DL | Note of Thi" prefix=og:http://ogp.me/ns# property=og:title><meta content="This is my note for the course (Neural Networks and Deep Learning). The codes in this note are rewritten to be more clear and concise. 👉..." name=description><meta content="This is my note for the course (Neural Networks and Deep Learning). The codes in this note are rewritten to be more clear and concise. 👉..." prefix=og:http://ogp.me/ns# property=og:description><meta content=summary_large_image name=twitter:card><meta content=@dinhanhthi name=twitter:site><meta content=@dinhanhthi name=twitter:creator><meta content=https://dinhanhthi.com/img_src/cover.png prefix=og:http://ogp.me/ns# property=og:image><meta content=article prefix=og:http://ogp.me/ns# property=og:type><link href=https://dinhanhthi.com/deeplearning-ai-course-1/ rel=canonical><meta content=https://dinhanhthi.com/deeplearning-ai-course-1/ prefix=og:http://ogp.me/ns# property=og:url><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="🔥 Anh-Thi DINH"><link href=/ rel=preconnect crossorigin><link href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET><script src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js defer crossorigin=anonymous integrity=sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js defer crossorigin=anonymous integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl onload=renderMathInElement(document.body);></script><style>body {
      visibility: hidden;
      opacity: 0;
    }</style><noscript><style>body {
        visibility: visible;
        opacity: 1;
      }</style></noscript><script csp-hash>if (/Mac OS X/.test(navigator.userAgent))
      document
        .documentElement
        .classList
        .add('apple')</script><link href=/src/css/main.css rel=stylesheet type=text/css><style>@font-face{font-display:swap;font-family:'fontello';src:url(/fontello/font/fontello.eot?46432155);src:url(/fontello/font/fontello.eot?46432155#iefix) format('embedded-opentype'),url(/fontello/font/fontello.woff2?46432155) format('woff2'),url(/fontello/font/fontello.woff?46432155) format('woff'),url(/fontello/font/fontello.ttf?46432155) format('truetype'),url(/fontello/font/fontello.svg?46432155#fontello) format('svg');font-weight:400;font-style:normal}[class*=" icon-"]:before,[class^=icon-]:before{font-family:"fontello";font-style:normal;font-weight:400;speak:never;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-doc:before{content:'\e800'}.icon-doc-add:before{content:'\e801'}.icon-stats:before{content:'\e802'}.icon-tags:before{content:'\e803'}.icon-like:before{content:'\e804'}.icon-cog-alt:before{content:'\e805'}.icon-project:before{content:'\e806'}.icon-mooc:before{content:'\e807'}.icon-dl:before{content:'\e808'}.icon-ml:before{content:'\e809'}.icon-python:before{content:'\e80a'}.icon-nlp:before{content:'\e80b'}.icon-r-lang:before{content:'\e80c'}.icon-skill:before{content:'\e80d'}.icon-js-solid:before{content:'\e80e'}.icon-game:before{content:'\e80f'}.icon-web:before{content:'\e810'}.icon-algo:before{content:'\e811'}.icon-mooc-solid:before{content:'\e812'}.icon-chatbot:before{content:'\e813'}.icon-web-dev:before{content:'\e814'}.icon-data:before{content:'\e815'}.icon-skill-solid:before{content:'\e816'}.icon-python-solid:before{content:'\e817'}.icon-project-solid:before{content:'\e818'}.icon-js:before{content:'\e819'}.icon-rocket:before{content:'\e81a'}.icon-ml-solid:before{content:'\e81b'}.icon-game-solid:before{content:'\e81c'}.icon-dl-solid:before{content:'\e81d'}.icon-nlp-solid:before{content:'\e81e'}.icon-web-solid:before{content:'\e81f'}.icon-algo-solid:before{content:'\e820'}.icon-puzzle-outline:before{content:'\e821'}.icon-ng:before{content:'\e822'}.icon-ok:before{content:'\e823'}.icon-link:before{content:'\e824'}.icon-down-circle:before{content:'\e826'}.icon-api:before{content:'\e828'}.icon-right-circle:before{content:'\e829'}.icon-down-open:before{content:'\e82a'}.icon-right-open:before{content:'\e82b'}.icon-copy:before{content:'\f0c5'}.icon-gamepad:before{content:'\f11b'}.icon-fork:before{content:'\f126'}.icon-mlops-solid:before{content:'\f135'}.icon-edu-solid:before{content:'\f19d'}.icon-others-solid:before{content:'\f1b3'}.icon-ds-solid:before{content:'\f1c0'}.icon-chart-area:before{content:'\f1fe'}.icon-chart-pie:before{content:'\f200'}.icon-ts:before{content:'\f201'}.icon-clone:before{content:'\f24d'}</style><body><script>function showTheme() {
        const btn = document.getElementById("toggle-dark-light");
        let toggleIcon = btn.firstElementChild;
        const currentTheme = localStorage.getItem("theme");
        if (currentTheme === "dark") {
          document
            .body
            .classList
            .toggle("dark-theme");
          toggleIcon.src = "/img_src/nav/sun.svg";
        } else if (currentTheme === "light") {
          document
            .body
            .classList
            .toggle("light-theme");
          toggleIcon.src = "/img_src/nav/moon.svg";
        }
      }
      function showContent() {
        document.body.style.visibility = 'visible';
        document.body.style.opacity = 1;
      }
      window.addEventListener('DOMContentLoaded', (event) => {
        showTheme();
        showContent();
      });</script><header class="wave-border wave-border-post"><nav><div id=nav><a href=/ class="nav-item no-effect"><img alt=home class=keep-original src=/img_src/nav/home.svg height=18 width=18> <span>Thi</span> </a><a href=/about/ class="nav-item no-effect"><img alt=about class=keep-original src=/img_src/nav/about.svg height=15 width=15> <span>About</span></a><div class=nav-search id=nav-search><form><input aria-label='search notes (press "/" to focus & "ESC" to lose)' autocomplete=off class=nav-search__input id=nav-search__input onfocusin=inFocus(this) placeholder='search notes (press "/" to focus & "ESC" to lose)' type=search></form><div id=nav-search__result-container style="display: none;"><ul id=nav-search__ul></ul><div id=nav-search__no-result style="display: none;"><p>No results found.</div></div></div><span class="nav-item no-effect nav-dark-light" href="" id=toggle-dark-light><img alt=light-mode class=keep-original src=/img_src/nav/moon.svg height=20 width=20> </span><a href=https://github.com/dinhanhthi class="nav-item no-effect nav-github" target=_blank><img alt=github class=keep-original src=/img_src/nav/github.svg height=20 width=20></a></div><div class=reading-progress-container><div id=reading-progress aria-hidden=true></div></div></nav><script>var divNavSearch=document.getElementById("nav-search"),divRes=document.getElementById("nav-search__result-container"),ulRes=document.getElementById("nav-search__ul");function inFocus(e){""!=e.value&&(divRes.style.display="block")}var isOnDiv=!1;divRes.addEventListener("mouseover",(function(){isOnDiv=!0})),divRes.addEventListener("mouseout",(function(){isOnDiv=!1}));var inputSearch=document.getElementById("nav-search__input");window.addEventListener("click",(function(){ulRes.getElementsByTagName("li").length>=1&&isOnDiv||(divRes.style.display="none")})),inputSearch.addEventListener("click",(e=>{e.stopPropagation()}));const addSelected=e=>{ulRes.querySelectorAll("li").forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected")};var isInView=(e,t)=>{var n=e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight;return e.offsetTop<t.scrollTop?"above":n?"below":"in"};const updateScroll=(e,t)=>{e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight&&(t.scrollTop=e.offsetTop+e.offsetHeight-t.offsetHeight),e.offsetTop<t.scrollTop&&(t.scrollTop=e.offsetTop)};document.onkeydown=e=>{checkInInput=document.activeElement==inputSearch,"/"!==e.key||checkInInput||(e.stopPropagation(),e.preventDefault(),inputSearch.focus())},document.addEventListener("focusin",(e=>{divNavSearch.contains(e.target)||(divRes.style.display="none")})),inputSearch.onkeydown=e=>{if("Enter"===e.key){e.stopPropagation(),e.preventDefault();var t=ulRes.querySelector('li[class*="selected"]');window.location.href=t.getElementsByClassName("item__content")[0].firstChild.firstChild.href}"Escape"===e.key&&(divRes.style.display="none",inputSearch.blur())},divNavSearch.onkeydown=e=>{if(hasResult=ulRes.getElementsByTagName("li").length>=1,hasResult){["ArrowUp","ArrowDown"].indexOf(e.key)>-1&&e.preventDefault();var t=ulRes.firstChild,n=ulRes.lastChild,s=ulRes.querySelector('li[class*="selected"]');switch(e.key){case"ArrowUp":nextLi=s&&s!=t?s.previousSibling:n,addSelected(nextLi),s=nextLi,updateScroll(s,divRes);break;case"ArrowDown":nextLi=s&&s!=n?s.nextSibling:t,addSelected(nextLi),s=nextLi,updateScroll(s,divRes)}}};</script><div class=header-container><div class="header-logo post-layout"><img alt="DL 1 - NN and DL" class=keep-original src=/img/header/deeplearning-ai.png height=55 width=55></div><h1>DL 1 - NN and DL</h1><div id=more-info><div id=note-tag><a href=/tags/mooc/ id=category }>MOOC</a> <a href=/tags/deeplearning.ai/ id=category }>deeplearning.ai</a> <a href=/tags/deep-learning/ id=category }>Deep Learning</a></div><div id=last-modified>Last modified 2 years ago / <a href=https://github.com/dinhanhthi/notes/edit/master/./posts/mooc/2020-04-04-deeplearning-ai-course-1.md>Edit on Github</a></div></div></div></header><main class="" id=main-wrapper><article class=post-container><div class="container mt-2 normal page-note"><div class="danger not-full-warning"><div class=warning-icon><img alt=Warning class=keep-original src=/img_src/icons/time.svg></div><div>This post was <strong>updated more than 1 year ago</strong>, some information may be outdated!</div></div><div class="toc toc-common toc-js"><div class=ol-container><div class=toc-heading>In this note</div><ol><li><a href=#activation-functions>Activation functions</a><ol><li><a href=#why-non-linear-activation-functions-in-nn-model%3F>Why non-linear activation functions in NN Model?</a><li><a href=#sigmoid-function>Sigmoid function</a><li><a href=#softmax-function>Softmax function</a><li><a href=#tanh-function-(hyperbolic-tangent)>tanh function (Hyperbolic tangent)</a><li><a href=#relu>ReLU</a></ol><li><a href=#logistic-regression>Logistic Regression</a><ol><li><a href=#gradient-descent>Gradient Descent</a><li><a href=#code>Code</a></ol><li><a href=#neural-network-overview>Neural Network overview</a><ol><li><a href=#notations>Notations</a><li><a href=#dimensions>Dimensions</a><li><a href=#l-layer-deep-neural-network>L-layer deep neural network</a><li><a href=#initialize-parameters>Initialize parameters</a><li><a href=#forward-%26-backward-propagation>Forward & Backward Propagation</a><li><a href=#code-1>Code</a></ol><li><a href=#parameters-vs-hyperparameters>Parameters vs Hyperparameters</a><li><a href=#comments>Comments</a><li><a href=#application%3A-recognize-a-cat>Application: recognize a cat</a><li><a href=#python-tips>Python tips</a></ol></div></div><p>This is my note for the course (<a href="https://www.coursera.org/learn/neural-networks-deep-learning?specialization=deep-learning">Neural Networks and Deep Learning</a>). The codes in this note are rewritten to be more clear and concise.<p>👉 <strong>Course 1</strong> -- <a href=/deeplearning-ai-course-1/ >Neural Networks and Deep Learning</a>.<br>👉 <strong>Course 2</strong> -- <a href=/deeplearning-ai-course-2/ >Improving Deep Neural Networks: Hyperparameter tuning, Regularization and Optimization</a>.<br>👉 <strong>Course 3</strong> -- <a href=/deeplearning-ai-course-3/ >Structuring Machine Learning Projects</a>.<br>👉 <strong>Course 4</strong> -- <a href=https://www.notion.so/dinhanhthi/CNN-by-deeplearning-ai-a081d253fc2c4c0b99edd2757c759b9e>Convolutional Neural Networks</a>.<br>👉 <strong>Course 5</strong> -- <a href=https://www.notion.so/dinhanhthi/Sequence-models-by-deeplearning-ai-427774f7b31846fdb17ac09cd2353fbe>Sequence Models</a>.<p>If you want to break into cutting-edge AI, this course will help you do so.<h2 id=activation-functions tabindex=-1>Activation functions <a href=#activation-functions class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><p>👉 Check <a href=https://en.wikipedia.org/wiki/Activation_function#Comparison_of_activation_functions>Comparison of activation functions</a> on wikipedia.<h3 id=why-non-linear-activation-functions-in-nn-model%3F tabindex=-1>Why non-linear activation functions in NN Model? <a href=#why-non-linear-activation-functions-in-nn-model%3F class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><p>Suppose <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>g</mi><mo stretchy=false>(</mo><mi>z</mi><mo stretchy=false>)</mo><mo>=</mo><mi>z</mi></mrow><annotation encoding=application/x-tex>g(z)=z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>g</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span></span></span></span></span> (linear)<section class=eqn><eqn><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><msup><mi>a</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mi>g</mi><mo stretchy=false>(</mo><msup><mi>z</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msup><mi>z</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>)</mo><mo>=</mo><msup><mi>w</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mi>x</mi><mo>+</mo><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mspace width=1em><mtext>(linear)</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><msup><mi>a</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mi>g</mi><mo stretchy=false>(</mo><msup><mi>z</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msup><mi>z</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>)</mo><mo>=</mo><msup><mi>w</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msup><msup><mi>a</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mo stretchy=false>(</mo><msup><mi>w</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msup><msup><mi>w</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>)</mo><mi>x</mi><mo>+</mo><mo stretchy=false>(</mo><msup><mi>w</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msup><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>)</mo><mspace width=1em><mtext>(linear again)</mtext><mi mathvariant=normal>.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} a^{[1]} &= g(z^{[1]} = z^{[1]}) = w^{[1]}x + b^{[1]} \quad \text{(linear)} \\ a^{[1]} &= g(z^{[2]} = z^{[2]}) = w^{[2]}a^{[1]} + b^{[2]} \\ &= (w^{[2]}w^{[1]})x + (w^{[2]}b^{[1]} + b^{[2]}) \quad \text{(linear again)}. \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:4.794em;vertical-align:-2.147em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.647em;><span style=top:-4.709em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.111em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span><span style=top:-1.513em;><span class=pstrut style=height:3em;></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.147em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.647em;><span style=top:-4.709em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:1em;></span><span class="mord text"><span class=mord>(linear)</span></span></span></span><span style=top:-3.111em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span><span style=top:-1.513em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class="mord mathnormal">x</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.938em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:1em;></span><span class="mord text"><span class=mord>(linear again)</span></span><span class=mord>.</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.147em;><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>You might not have any hidden layer! Your model is just Logistic Regression, no hidden unit! <mark>Just use non-linear activations for hidden layers!</mark><h3 id=sigmoid-function tabindex=-1>Sigmoid function <a href=#sigmoid-function class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><ul><li>Usually used in the output layer in the binary classification.<li><mark>Don't use sigmoid in the hidden layers!</mark></ul><div class=columns-2 markdown=1><section class=eqn><eqn><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mi>σ</mi><mo stretchy=false>(</mo><mi>z</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mi>σ</mi><mo stretchy=false>(</mo><mi>z</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mover><mo stretchy=true minsize=3.0em>→</mo><mpadded lspace=0.3em width=+0.6em><mrow><mi>z</mi><mo>→</mo><mi mathvariant=normal>∞</mi></mrow></mpadded></mover><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mi>σ</mi><mo stretchy=false>(</mo><mi>z</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mover><mo stretchy=true minsize=3.0em>→</mo><mpadded lspace=0.3em width=+0.6em><mrow><mi>z</mi><mo>→</mo><mo>−</mo><mi mathvariant=normal>∞</mi></mrow></mpadded></mover><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><msup><mi>σ</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mi>σ</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} \sigma(z) &= \dfrac{1}{1+e^{-z}} \\ \sigma(z) &\xrightarrow{z\to \infty} 1 \\ \sigma(z) &\xrightarrow{z\to -\infty} 0 \\ \sigma'(x) &= \sigma(x) (1 - \sigma(x)) \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:7.1645em;vertical-align:-3.3322em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.8322em;><span style=top:-5.8322em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mclose>)</span></span></span><span style=top:-3.8395em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mclose>)</span></span></span><span style=top:-2.1492em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mclose>)</span></span></span><span style=top:-0.6492em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8019em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.3322em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.8322em;><span style=top:-5.8322em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6973em;><span style=top:-2.989em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.7693em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style=top:-3.8395em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.9234em;><span style=top:-3.322em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3 x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span><span class="mtight mrel">→</span><span class="mord mtight">∞</span></span></span></span><span class=svg-align style=top:-2.689em;><span class=pstrut style=height:2.7em;></span><span class=hide-tail style=height:0.522em;min-width:1.469em;><svg height=0.522em preserveAspectRatio="xMaxYMin slice" viewBox="0 0 400000 522" width=400em xmlns=http://www.w3.org/2000/svg><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.011em;><span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>1</span></span></span><span style=top:-2.1492em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0303em;><span style=top:-3.322em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3 x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span><span class="mtight mrel">→</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span class=svg-align style=top:-2.689em;><span class=pstrut style=height:2.7em;></span><span class=hide-tail style=height:0.522em;min-width:1.469em;><svg height=0.522em preserveAspectRatio="xMaxYMin slice" viewBox="0 0 400000 522" width=400em xmlns=http://www.w3.org/2000/svg><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.011em;><span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>0</span></span></span><span style=top:-0.6492em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>))</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.3322em;><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p><img alt="sigmoid function" class="img-100 bg-white" src=/img/post/mooc/dl/sigmoid.png><br><em>Signmoid function graph on Wikipedia.</em></div><div class=col-2-equal><pre class=language-python><code class=language-python><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<br><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<br><br><span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><pre class=language-python><code class=language-python><span class="token keyword">def</span> <span class="token function">sigmoid_derivative</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">return</span> sigmoid<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sigmoid<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><h3 id=softmax-function tabindex=-1>Softmax function <a href=#softmax-function class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=columns-2 markdown=1><p>The output of the softmax function can be used to represent a categorical distribution – that is, a probability distribution over <mark>K different possible</mark> outcomes.<p><img alt="softmax function" class=img-100 src=/img/post/mooc/dl/softmax.png><br><em>Udacity Deep Learning Slide on Softmax</em></div><div class=columns-2 markdown=1><section class=eqn><eqn><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>σ</mi><mo stretchy=false>(</mo><mi mathvariant=bold>z</mi><msub><mo stretchy=false>)</mo><mi>i</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>z</mi><mi>i</mi></msub></msup><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msup><mi>e</mi><msub><mi>z</mi><mi>j</mi></msub></msup></mrow></mfrac><mtext> for </mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>K</mi><mtext> and </mtext><mi mathvariant=bold>z</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mi>K</mi></msup></mrow><annotation encoding=application/x-tex>\sigma (\mathbf {z} )_{i}={\frac {e^{z_{i}}}{\sum _{j=1}^{K}e^{z_{j}}}}{\text{ for }}i=1,\dotsc ,K{\text{ and }}\mathbf {z}\in \mathbb {R} ^{K}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathbf">z</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:2.6484em;vertical-align:-1.307em;></span><span class=mord><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3414em;><span style=top:-2.1288em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0em;>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.9812em;><span style=top:-2.4003em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4358em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6065em;><span style=top:-3.0051em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3281em;><span style=top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2819em;><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3281em;><span style=top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.143em;><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.307em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class=mord><span class="mord text"><span class=mord> for </span></span></span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em;></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=mord><span class="mord text"><span class=mord> and </span></span></span><span class="mord mathbf">z</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8913em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8913em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>K</span></span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><pre class=language-python><code class=language-python><span class="token keyword">def</span> <span class="token function">softmax</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    z_exp <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z<span class="token punctuation">)</span><br>    z_sum <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>z_exp<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><br>    <span class="token keyword">return</span> z_exp <span class="token operator">/</span> z_sum</code></pre></div><h3 id=tanh-function-(hyperbolic-tangent) tabindex=-1>tanh function (Hyperbolic tangent) <a href=#tanh-function-(hyperbolic-tangent) class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><ul><li>tanh is better than sigmoid because mean <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>→</mo></mrow><annotation encoding=application/x-tex>\to</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.3669em;></span><span class=mrel>→</span></span></span></span></span> 0 and it centers the data better for the next layer.<li>Don't use sigmoid on hidden units except for the output layer because in the case <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>0</mn><mo>≤</mo><mover accent=true><mi>y</mi><mo>^</mo></mover><mo>≤</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>0 \le \hat{y} \le 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.7804em;vertical-align:-0.136em;></span><span class=mord>0</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.6944em;><span style=top:-3em;><span class=pstrut style=height:3em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>y</span></span><span style=top:-3em;><span class=pstrut style=height:3em;></span><span class=accent-body style=left:-0.1944em;><span class=mord>^</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.1944em;><span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span></span>, sigmoid is better than tanh.</ul><div class=columns-2 markdown=1><div markdown=1><section class=eqn><eqn><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>σ</mi><mo stretchy=false>(</mo><mi>z</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>z</mi></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>z</mi></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>\sigma(z) = \dfrac{e^{z} - e^{-z}}{e^{z} + e^{-z}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:2.2177em;vertical-align:-0.7693em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.4483em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.5904em;><span style=top:-2.989em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6973em;><span style=top:-2.989em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7713em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.7693em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section><pre class=language-python><code class=language-python><span class="token keyword">def</span> <span class="token function">tanh</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">return</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><p><img alt="tanh function" class="img-100 bg-white" src=/img/post/mooc/dl/tanh.png><br><em>Graph of tanh from analyticsindiamag.</em></div><h3 id=relu tabindex=-1>ReLU <a href=#relu class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><ul><li>ReLU (<strong>R</strong>ectified <strong>L</strong>inear <strong>U</strong>nit).<li>Its derivative is much different from 0 than sigmoid/tanh <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>→</mo></mrow><annotation encoding=application/x-tex>\to</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.3669em;></span><span class=mrel>→</span></span></span></span></span> learn faster!<li><mark>If you aren't sure which one to use in the activation, use ReLU!</mark><li>Weakness: derivative ~ 0 in the negative side, we use <strong>Leaky ReLU</strong> instead! However, <mark>Leaky ReLU aren't used much in practice</mark>!</ul><div class=columns-2 markdown=1><div markdown=1><section class=eqn><eqn><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>σ</mi><mo stretchy=false>(</mo><mi>z</mi><mo stretchy=false>)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false>(</mo><mn>0</mn><mo separator=true>,</mo><mi>z</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\sigma(z) = \max(0,z)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mop>max</span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mclose>)</span></span></span></span></span></eqn></section><pre class=language-python><code class=language-python><span class="token keyword">def</span> <span class="token function">relu</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>maximum<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span></code></pre></div><p><img alt="relu vs leaky relu" class=img-100 src=/img/post/mooc/dl/relu-leaky.jpg><br><em>ReLU (left) and Leaky ReLU (right)</em></div><h2 id=logistic-regression tabindex=-1>Logistic Regression <a href=#logistic-regression class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li>Usually used for binary classification (there are only <mark>2 outputs</mark>). In the case of multiclass classification, we can use <em>one vs all</em> (couple multiple logistic regression steps).</ul><h3 id=gradient-descent tabindex=-1>Gradient Descent <a href=#gradient-descent class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><p>Gradient Descent is an algorithm to minimizing the cose function <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>J</mi></mrow><annotation encoding=application/x-tex>J</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span></span></span></span></span>. It contains 2 steps: <strong>Forward Propagation</strong> (From <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>X</mi></mrow><annotation encoding=application/x-tex>X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span></span></span></span></span> to compute the cost <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>J</mi></mrow><annotation encoding=application/x-tex>J</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span></span></span></span></span>) and <strong>Backward Propagation</strong> (compute derivaties and optimize the parameters <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi><mo separator=true>,</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>w, b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">b</span></span></span></span></span>).<p>Initialize <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi><mo separator=true>,</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>w, b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">b</span></span></span></span></span> and then <mark>repeat until convergence</mark> (<span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span></span></span></span></span>: number of training examples, <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>α</mi></mrow><annotation encoding=application/x-tex>\alpha</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.0037em;>α</span></span></span></span></span>: learning rate, <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>J</mi></mrow><annotation encoding=application/x-tex>J</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span></span></span></span></span>: cost function, <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi></mrow><annotation encoding=application/x-tex>A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">A</span></span></span></span></span>: activation function):<p class=indent><ol><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mo>=</mo><mi>σ</mi><mo stretchy=false>(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>X</mi><mo>+</mo><mi>b</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>A = \sigma(w^TX + b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">A</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0913em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8413em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">b</span><span class=mclose>)</span></span></span></span></span><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>J</mi><mo stretchy=false>(</mo><mi>w</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mrow><mo fence=true>(</mo><mi>Y</mi><mi>log</mi><mo>⁡</mo><msup><mi>A</mi><mi>T</mi></msup><mo>+</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mi>Y</mi><mo stretchy=false>)</mo><mi>log</mi><mo>⁡</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy=false>)</mo><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>J(w,b) = -\frac{1}{m} \left( Y \log A^T + (1-Y)\log(1-A^T) \right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">b</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.2em;vertical-align:-0.35em;></span><span class=mord>−</span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.345em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.1667em;></span><span class=minner><span class="mopen delimcenter" style=top:0em;><span class="size1 delimsizing">(</span></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span><span class=mspace style=margin-right:0.1667em;></span><span class=mop>lo<span style=margin-right:0.01389em;>g</span></span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8413em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span><span class=mclose>)</span><span class=mspace style=margin-right:0.1667em;></span><span class=mop>lo<span style=margin-right:0.01389em;>g</span></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8413em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span><span class=mclose>)</span><span class="mclose delimcenter" style=top:0em;><span class="size1 delimsizing">)</span></span></span></span></span></span></span><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>∂</mi><mi>w</mi></msub><mi>J</mi><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi>X</mi><mo stretchy=false>(</mo><mi>A</mi><mo>−</mo><mi>Y</mi><msup><mo stretchy=false>)</mo><mi>T</mi></msup></mrow><annotation encoding=application/x-tex>\partial_{w}J = \frac{1}{m}X(A-Y)^T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em;></span><span class=mord><span class=mord style=margin-right:0.05556em;>∂</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.02691em;>w</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.1901em;vertical-align:-0.345em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.345em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mopen>(</span><span class="mord mathnormal">A</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.0913em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8413em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span></span></span></span></span><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>∂</mi><mi>b</mi></msub><mi>J</mi><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi mathvariant=normal>Σ</mi><mo stretchy=false>(</mo><mi>A</mi><mo>−</mo><mi>Y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\partial_{b}J = \frac{1}{m} \Sigma (A-Y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em;></span><span class=mord><span class=mord style=margin-right:0.05556em;>∂</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.1901em;vertical-align:-0.345em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.345em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord>Σ</span><span class=mopen>(</span><span class="mord mathnormal">A</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span><span class=mclose>)</span></span></span></span></span><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi><mo>:</mo><mo>=</mo><mi>w</mi><mo>−</mo><mi>α</mi><msub><mi mathvariant=normal>∂</mi><mi>w</mi></msub><mi>J</mi></mrow><annotation encoding=application/x-tex>w := w - \alpha \partial_{w}J</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em;></span><span class="mord mathnormal" style=margin-right:0.0037em;>α</span><span class=mord><span class=mord style=margin-right:0.05556em;>∂</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.02691em;>w</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span></span></span></span></span><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>b</mi><mo>:</mo><mo>=</mo><mi>b</mi><mo>−</mo><mi>α</mi><msub><mi mathvariant=normal>∂</mi><mi>b</mi></msub><mi>J</mi></mrow><annotation encoding=application/x-tex>b := b - \alpha \partial_{b}J</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7778em;vertical-align:-0.0833em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em;></span><span class="mord mathnormal" style=margin-right:0.0037em;>α</span><span class=mord><span class=mord style=margin-right:0.05556em;>∂</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span></span></span></span></span></ol><p>The <mark>dimension of variables</mark>: <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>X</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><msub><mi>n</mi><mi>x</mi></msub><mo>×</mo><mi>m</mi></mrow></msup><mo separator=true>,</mo><mi>Y</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><mn>1</mn><mo>×</mo><mi>m</mi></mrow></msup><mo separator=true>,</mo><mi>b</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><mn>1</mn><mo>×</mo><mi>m</mi></mrow></msup><mo separator=true>,</mo><mi>w</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><msub><mi>n</mi><mi>x</mi></msub><mo>×</mo><mn>1</mn></mrow></msup><mo separator=true>,</mo><mi>A</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><mn>1</mn><mo>×</mo><mi>m</mi></mrow></msup><mo separator=true>,</mo><mi>J</mi><mo>∈</mo><mi mathvariant=double-struck>R</mi></mrow><annotation encoding=application/x-tex>X\in \mathbb{R}^{n_x \times m}, Y\in \mathbb{R}^{1\times m}, b\in \mathbb{R}^{1\times m}, w\in \mathbb{R}^{n_x \times 1}, A\in \mathbb{R}^{1\times m}, J\in \mathbb{R}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.7224em;vertical-align:-0.0391em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.9658em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7713em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1645em;><span style=top:-2.357em;margin-left:0em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.143em;><span></span></span></span></span></span></span><span class="mtight mbin">×</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span><span class="mtight mbin">×</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span><span class="mtight mbin">×</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1645em;><span style=top:-2.357em;margin-left:0em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.143em;><span></span></span></span></span></span></span><span class="mtight mbin">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">A</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span><span class="mtight mbin">×</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6889em;></span><span class="mord mathbb">R</span></span></span></span></span>, <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>∂</mi><mi>w</mi></msub><mi>J</mi><mo>∈</mo><mi mathvariant=double-struck>R</mi></mrow><annotation encoding=application/x-tex>\partial_wJ \in \mathbb{R}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em;></span><span class=mord><span class=mord style=margin-right:0.05556em;>∂</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.02691em;>w</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6889em;></span><span class="mord mathbb">R</span></span></span></span></span>, <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>∂</mi><mi>b</mi></msub><mi>J</mi><mo>∈</mo><mi mathvariant=double-struck>R</mi></mrow><annotation encoding=application/x-tex>\partial_bJ \in \mathbb{R}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em;></span><span class=mord><span class=mord style=margin-right:0.05556em;>∂</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6889em;></span><span class="mord mathbb">R</span></span></span></span></span>.<h3 id=code tabindex=-1>Code <a href=#code class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><pre class=language-python><code class=language-python><span class="token keyword">def</span> <span class="token function">logistic_regression_model</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> Y_test<span class="token punctuation">,</span><br>                              num_iterations <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">,</span> learning_rate <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    m <span class="token operator">=</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># number of training examples</span><br><br>    <span class="token comment"># INITIALIZE w, b</span><br>    w <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    b <span class="token operator">=</span> <span class="token number">0</span><br><br>    <span class="token comment"># GRADIENT DESCENT</span><br>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token comment"># FORWARD PROPAGATION (from x to cost)</span><br>        A <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>w<span class="token punctuation">.</span>T<span class="token punctuation">,</span> X_train<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span><br>        cost <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>A<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><br>               <span class="token operator">+</span> p<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Y<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>A<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>        <span class="token comment"># BACKWARD PROPAGATION (find grad)</span><br>        dw <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> <span class="token punctuation">(</span>A<span class="token operator">-</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span><br>        db <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>A<span class="token operator">-</span>Y<span class="token punctuation">)</span><br>        cost <span class="token operator">=</span> np<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>cost<span class="token punctuation">)</span><br><br>        <span class="token comment"># OPTIMIZE</span><br>        w <span class="token operator">=</span> w <span class="token operator">-</span> learning_rate<span class="token operator">*</span>dw<br>        b <span class="token operator">=</span> b <span class="token operator">-</span> learning_rate<span class="token operator">*</span>db<br><br>    <span class="token comment"># PREDICT (with optimized w, b)</span><br>    Y_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    w <span class="token operator">=</span> w<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><br><br>    A <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>w<span class="token punctuation">.</span>T<span class="token punctuation">,</span>X_test<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span><br>    Y_pred_test <span class="token operator">=</span> A <span class="token operator">></span> <span class="token number">0.5</span></code></pre><h2 id=neural-network-overview tabindex=-1>Neural Network overview <a href=#neural-network-overview class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><h3 id=notations tabindex=-1>Notations <a href=#notations class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=two-columns-list markdown=1><ul><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>X</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>X^{(i)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span></span> : <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span></span>th training example.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span></span></span></span></span> : number of examples.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">L</span></span></span></span></span> : number of layers.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mn>0</mn><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msub><mi>n</mi><mi>X</mi></msub></mrow><annotation encoding=application/x-tex>n^{[0]} = n_X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">0</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.07847em;>X</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span></span> : number of features (# nodes in the input).<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>n^{[L]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span> : number of nodes in the output layer.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>n^{[l]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span> : number of nodes in the hidden layers.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>w</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>w^{[l]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span> : weights for <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>z^{[l]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>a</mi><mrow><mo stretchy=false>[</mo><mn>0</mn><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mi>X</mi></mrow><annotation encoding=application/x-tex>a^{[0]} = X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">0</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span></span></span></span></span> : activation in the input layer.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>a</mi><mi>i</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo></mrow></msubsup></mrow><annotation encoding=application/x-tex>a^{[2]}_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3217em;vertical-align:-0.2769em;></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em;><span style=top:-2.4231em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.2198em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2769em;><span></span></span></span></span></span></span></span></span></span></span> : activation in layer <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>2</mn></mrow><annotation encoding=application/x-tex>2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>2</span></span></span></span></span>, node <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>a</mi><mrow><mo stretchy=false>[</mo><mn>2</mn><mo stretchy=false>]</mo><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>a^{[2](i)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">2</span><span class="mtight mclose">]</span><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span></span> : activation in layer <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>2</mn></mrow><annotation encoding=application/x-tex>2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>2</span></span></span></span></span>, example <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>a</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mover accent=true><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding=application/x-tex>a^{[L]} = \hat{y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.6944em;><span style=top:-3em;><span class=pstrut style=height:3em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>y</span></span><span style=top:-3em;><span class=pstrut style=height:3em;></span><span class=accent-body style=left:-0.1944em;><span class=mord>^</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.1944em;><span></span></span></span></span></span></span></span></span></span>.</ul></div><h3 id=dimensions tabindex=-1>Dimensions <a href=#dimensions class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=two-columns-list markdown=1><ul><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mn>0</mn><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mi>X</mi><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mn>0</mn><mo stretchy=false>]</mo></mrow></msup><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding=application/x-tex>A^{[0]} = X \in \mathbb{R}^{n^{[0]} \times m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">0</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7224em;vertical-align:-0.0391em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0397em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0397em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9667em;><span style=top:-2.9667em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">0</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class="mtight mbin">×</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span></span><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo separator=true>,</mo><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding=application/x-tex>Z^{[l]}, A^{[l]} \in \mathbb{R}^{n^{[l]}\times m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0824em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0397em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0397em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9667em;><span style=top:-2.9667em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class="mtight mbin">×</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo separator=true>,</mo><mi>d</mi><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding=application/x-tex>dZ^{[l]}, dA^{[l]} \in \mathbb{R}^{n^{[l]}\times m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0824em;vertical-align:-0.1944em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0397em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0397em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9667em;><span style=top:-2.9667em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class="mtight mbin">×</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo separator=true>,</mo><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><msup><mo>×</mo><mrow><mo stretchy=false>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup></mrow></msup></mrow><annotation encoding=application/x-tex>dW^{[l]}, W^{[l]} \in \mathbb{R}^{n^{[l]} \times ^{[l-1]}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0824em;vertical-align:-0.1944em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0397em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0397em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9667em;><span style=top:-2.9667em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mtight mbin">×</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9667em;><span style=top:-2.9667em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mbin">−</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo separator=true>,</mo><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant=double-struck>R</mi><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>×</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>db^{[l]}, b^{[l]} \in \mathbb{R}^{n^{[l]} \times 1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0824em;vertical-align:-0.1944em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0397em;></span><span class=mord><span class="mord mathbb">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0397em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9667em;><span style=top:-2.9667em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class="mtight mbin">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>.</ul></div><h3 id=l-layer-deep-neural-network tabindex=-1>L-layer deep neural network <a href=#l-layer-deep-neural-network class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=columns-2 markdown=1><p><img alt="L-layer deep neural network" class="img-95 pop" src=/img/post/mooc/dl/l-layer-dnn.png><br><em>L-layer deep neural network. Image from the course.</em><div><ol><li>Initialize parameters / Define hyperparameters<li>Loop for num_iterations:<ol><li>Forward propagation<li>Compute cost function<li>Backward propagation<li>Update parameters (using parameters, and grads from backprop)</ol><li>Use trained parameters to predict labels.</ol></div></div><h3 id=initialize-parameters tabindex=-1>Initialize parameters <a href=#initialize-parameters class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><ul><li>In the <mark>Logistic Regression, we use <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>0</mn></mrow><annotation encoding=application/x-tex>0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>0</span></span></span></span></span> for <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi><mo separator=true>,</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>w, b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">b</span></span></span></span></span></mark> (it's OK because LogR doesn't have hidden layers) but <mark>we can't in the NN model</mark>!<li>If we use <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>0</mn></mrow><annotation encoding=application/x-tex>0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>0</span></span></span></span></span>, we'll meet the <strong>completely symmetric problem</strong>. No matter how long you train your NN, hidden units compute exactly the same function <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>⇒</mo></mrow><annotation encoding=application/x-tex>\Rightarrow</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.3669em;></span><span class=mrel>⇒</span></span></span></span></span> No point to having more than 1 hidden unit!<li>We <mark>add a little bit in <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>W</mi></mrow><annotation encoding=application/x-tex>W</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.13889em;>W</span></span></span></span></span></mark> and <mark>keep <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>0</mn></mrow><annotation encoding=application/x-tex>0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>0</span></span></span></span></span> in <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">b</span></span></span></span></span></mark>.</ul><h3 id=forward-%26-backward-propagation tabindex=-1>Forward & Backward Propagation <a href=#forward-%26-backward-propagation class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><p><img alt="Blocks of forward and backward propagation deep NN" class=img-70 src=/img/post/mooc/dl/for-back-prop-animation.gif><br><em>Blocks of forward and backward propagation deep NN. Unknown source.</em><p><img alt="Blocks of forward and backward propagation deep NN" class=img-90 src=/img/post/mooc/dl/backprop_kiank.png><br><em>Blocks of forward and backward propagation deep NN. Image from the course.</em><p><strong>Forward Propagation</strong>: Loop through number of layers:<p class=indent><ol><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mn>0</mn><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mi>X</mi></mrow><annotation encoding=application/x-tex>A^{[0]} = X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mtight">0</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span></span></span></span></span><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>Z^{[l]} = W^{[l]}A^{[l-1]} + b^{[l]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.9713em;vertical-align:-0.0833em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mbin">−</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span> (linear)<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msup><mi>σ</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>(</mo><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>A^{[l]} = \sigma^{[l]}(Z^{[l]})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.138em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span> (for <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi><mo>=</mo><mn>1</mn><mo>…</mo><mi>L</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>l=1 \ldots L-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class=mord>1</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">L</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span></span>, non-linear activations)<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msup><mi>σ</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>(</mo><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>A^{[L]} = \sigma^{[L]}(Z^{[L]})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.138em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span> (sigmoid function)</ol><p><strong>Cost function</strong>: <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>J</mi><mo stretchy=false>(</mo><mi>w</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mrow><mo fence=true>(</mo><mi>Y</mi><mi>log</mi><mo>⁡</mo><msup><mi>A</mi><mi>T</mi></msup><mo>+</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mi>Y</mi><mo stretchy=false>)</mo><mi>log</mi><mo>⁡</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy=false>)</mo><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>J(w,b) = -\frac{1}{m} \left( Y \log A^T + (1-Y)\log(1-A^T) \right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.09618em;>J</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02691em;>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">b</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.2em;vertical-align:-0.35em;></span><span class=mord>−</span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.345em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.1667em;></span><span class=minner><span class="mopen delimcenter" style=top:0em;><span class="size1 delimsizing">(</span></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span><span class=mspace style=margin-right:0.1667em;></span><span class=mop>lo<span style=margin-right:0.01389em;>g</span></span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8413em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal" style=margin-right:0.22222em;>Y</span><span class=mclose>)</span><span class=mspace style=margin-right:0.1667em;></span><span class=mop>lo<span style=margin-right:0.01389em;>g</span></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8413em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span><span class=mclose>)</span><span class="mclose delimcenter" style=top:0em;><span class="size1 delimsizing">)</span></span></span></span></span></span></span><p><strong>Backward Propagation</strong>: Loop through number of layers<p class=indent><ol><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mo>−</mo><mfrac><mi>y</mi><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup></mfrac><mo>+</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mi>y</mi></mrow><mrow><mn>1</mn><mo>−</mo><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>L</mi><mo stretchy=false>]</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>dA^{[L]} = -\frac{y}{A^{[L]}} + \frac{1-y}{1-A^{[L]}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.1329em;vertical-align:-0.3854em;></span><span class=mord>−</span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.7475em;><span style=top:-2.6146em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.822em;><span style=top:-2.822em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.4461em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em;>y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.3854em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.341em;vertical-align:-0.4438em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8972em;><span style=top:-2.6146em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span><span class="mtight mbin">−</span><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.822em;><span style=top:-2.822em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.4461em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span><span class="mtight mbin">−</span><span class="mord mathnormal mtight" style=margin-right:0.03588em;>y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4438em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>.<li>for <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi><mo>=</mo><mi>L</mi><mo>…</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>l=L \ldots 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">L</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span></span></span></span></span>, non-linear activations:<ol><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mi>d</mi><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>(</mo><msup><mi>σ</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><msup><mo stretchy=false>)</mo><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup><mo stretchy=false>(</mo><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>dZ^{[l]} = dA^{[l]} (\sigma^{[l]})'(Z^{[l]})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.138em;vertical-align:-0.25em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mfrac><mrow><mi>d</mi><mi>J</mi></mrow><mrow><mi mathvariant=normal>∂</mi><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi>d</mi><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo stretchy=false>(</mo><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy=false>]</mo><msup><mo stretchy=false>)</mo><mi>T</mi></msup></mrow></msup></mrow><annotation encoding=application/x-tex>dW^{[l]} = \frac{dJ}{\partial W^{[l]}} = \frac{1}{m} dZ^{[l]} (A^{[l-1])^T}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.2655em;vertical-align:-0.3854em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8801em;><span style=top:-2.6146em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight" style=margin-right:0.05556em;>∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.822em;><span style=top:-2.822em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.09618em;>dJ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.3854em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.3514em;vertical-align:-0.345em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.345em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0064em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mbin">−</span><span class="mord mtight">1</span><span class="mtight mclose">]</span><span class="mtight mclose"><span class="mtight mclose">)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9191em;><span style=top:-2.931em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mfrac><mrow><mi>d</mi><mi>J</mi></mrow><mrow><mi mathvariant=normal>∂</mi><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mi>σ</mi><mn>1</mn><mi>m</mi></msubsup><mi>d</mi><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo><mo stretchy=false>(</mo><mi>i</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>db^{[l]} = \frac{dJ}{\partial b^{[l]}} = \frac{1}{m}\sigma_1^m dZ^{[l](i)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.2655em;vertical-align:-0.3854em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8801em;><span style=top:-2.6146em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight" style=margin-right:0.05556em;>∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.822em;><span style=top:-2.822em;margin-right:0.0714em;><span class=pstrut style=height:2.5357em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.09618em;>dJ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.3854em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.233em;vertical-align:-0.345em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.345em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">1</span></span></span><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2481em;><span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span><span class="mtight mopen">(</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><msup><mi>A</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><mo stretchy=false>(</mo><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo><msup><mo stretchy=false>)</mo><mi>T</mi></msup></mrow></msup><mi>d</mi><msup><mi>Z</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>dA^{[l-1]} = (W^{[l])^T}dZ^{[l]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mbin">−</span><span class="mord mtight">1</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.2564em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0064em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span><span class="mtight mclose"><span class="mtight mclose">)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9191em;><span style=top:-2.931em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="mtight sizing reset-size3 size1"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>T</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span>.</ol></ol><p><strong>Update parameters</strong>: loop through number of layers (for <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi><mo>=</mo><mn>1</mn><mo>…</mo><mi>L</mi></mrow><annotation encoding=application/x-tex>l=1\ldots L</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class=mord>1</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">L</span></span></span></span></span>)<p class=indent><ol><li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>W^{[l]} = W^{[l]} - \alpha dW^{[l]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.9713em;vertical-align:-0.0833em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.888em;></span><span class="mord mathnormal" style=margin-right:0.0037em;>α</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>=</mo><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup><mo>−</mo><mi>α</mi><mi>d</mi><msup><mi>b</mi><mrow><mo stretchy=false>[</mo><mi>l</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>b^{[l]} = b^{[l]} - \alpha db^{[l]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.9713em;vertical-align:-0.0833em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.888em;></span><span class="mord mathnormal" style=margin-right:0.0037em;>α</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span>.</ol><h3 id=code-1 tabindex=-1>Code <a href=#code-1 class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><pre class=language-python><code class=language-python><span class="token keyword">def</span> <span class="token function">L_Layer_NN</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> layers_dims<span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.0075</span><span class="token punctuation">,</span><br>               num_iterations<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">,</span> print_cost<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    costs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><br>    m <span class="token operator">=</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># number of training examples</span><br>    L <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>layer_dims<span class="token punctuation">)</span>  <span class="token comment"># number of layers</span><br><br>    <span class="token comment"># INITIALIZE W, b</span><br>    params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'W'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><br>    <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        params<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>layer_dims<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">,</span> layer_dims<span class="token punctuation">[</span>l<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.01</span><br>        params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>layer_dims<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>    <span class="token comment"># GRADIENT DESCENT</span><br>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token comment"># FORWARD PROPAGATION (Linear -> ReLU x (L-1) -> Linear -> Sigmoid (L))</span><br>        A <span class="token operator">=</span> X<br>        caches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'A'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'W'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Z'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><br>        <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span><br>            caches<span class="token punctuation">[</span><span class="token string">'A_prev'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>A<span class="token punctuation">)</span><br>            <span class="token comment"># INITIALIZE W, b</span><br>            W <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span><br>            b <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span><br>            caches<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>W<span class="token punctuation">)</span><br>            caches<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>b<span class="token punctuation">)</span><br>            <span class="token comment"># RELU X (L-1)</span><br>            Z <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W<span class="token punctuation">,</span> A<span class="token punctuation">)</span> <span class="token operator">+</span> b<br>            <span class="token keyword">if</span> l <span class="token operator">!=</span> L<span class="token punctuation">:</span> <span class="token comment"># hidden layers</span><br>                A <span class="token operator">=</span> relu<span class="token punctuation">(</span>Z<span class="token punctuation">)</span><br>            <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># output layer</span><br>                A <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>Z<span class="token punctuation">)</span><br>            caches<span class="token punctuation">[</span><span class="token string">'Z'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>Z<span class="token punctuation">)</span><br><br>        <span class="token comment"># COST</span><br>        cost <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">-</span>Y<span class="token punctuation">.</span>T<span class="token punctuation">)</span><br><br>        <span class="token comment">#FORWARD PROPAGATION (Linear -> ReLU x (L-1) -> Linear -> Sigmoid (L))</span><br>        dA <span class="token operator">=</span> <span class="token operator">-</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>divide<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> A<span class="token punctuation">)</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>divide<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> Y<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> A<span class="token punctuation">)</span><span class="token punctuation">)</span><br>        grads <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'dW'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'db'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><br>        <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>            cache_Z <span class="token operator">=</span> caches<span class="token punctuation">[</span><span class="token string">'Z'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span><br>            <span class="token keyword">if</span> l <span class="token operator">!=</span> L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment"># hidden layers</span><br>                dZ <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>dA<span class="token punctuation">,</span> copy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><br>                dZ<span class="token punctuation">[</span>Z <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><br>            <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># output layer</span><br>                dZ <span class="token operator">=</span> dA <span class="token operator">*</span> sigmoid<span class="token punctuation">(</span>cache_Z<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sigmoid<span class="token punctuation">(</span>cache_Z<span class="token punctuation">)</span><span class="token punctuation">)</span><br>            cache_A_prev <span class="token operator">=</span> caches<span class="token punctuation">[</span><span class="token string">'A_prev'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span><br>            dW <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> cache_A_prev<span class="token punctuation">.</span>T<span class="token punctuation">)</span><br>            db <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><br>            dA <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W<span class="token punctuation">.</span>T<span class="token punctuation">,</span> dZ<span class="token punctuation">)</span><br>            grads<span class="token punctuation">[</span><span class="token string">'dW'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>dW<span class="token punctuation">)</span><br>            grads<span class="token punctuation">[</span><span class="token string">'db'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>db<span class="token punctuation">)</span><br><br>        <span class="token comment"># UPDATE PARAMETERS</span><br>        <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span><br>            params<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">-</span> grads<span class="token punctuation">[</span><span class="token string">'dW'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span><br>            params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">-</span> grads<span class="token punctuation">[</span><span class="token string">'db'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>l<span class="token punctuation">]</span><br><br>    <span class="token keyword">if</span> print_cost <span class="token keyword">and</span> i <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"Cost after iteration %i: %f"</span> <span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> cost<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> print_cost <span class="token keyword">and</span> i <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span><br>        costs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cost<span class="token punctuation">)</span><br><br>    <span class="token keyword">return</span> parameter</code></pre><h2 id=parameters-vs-hyperparameters tabindex=-1>Parameters vs Hyperparameters <a href=#parameters-vs-hyperparameters class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><strong>Parameters</strong>: <span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>W</mi><mo separator=true>,</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>W, b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.13889em;>W</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">b</span></span></span></span></span>.<li><strong>Hyperparameters</strong>:<ul><li>Learning rate (<span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>α</mi></mrow><annotation encoding=application/x-tex>\alpha</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.0037em;>α</span></span></span></span></span>).<li>Number of iterations (in gradient descent algorithm) (<code>num_iterations</code>).<li>Number of layers (<span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">L</span></span></span></span></span>).<li>Number of nodes in each layer (<span class=eq><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>n</mi><mrow><mo stretchy=false>[</mo><mi>i</mi><mo stretchy=false>]</mo></mrow></msup></mrow><annotation encoding=application/x-tex>n^{[i]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.888em;></span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.888em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mopen">[</span><span class="mord mathnormal mtight">i</span><span class="mtight mclose">]</span></span></span></span></span></span></span></span></span></span></span></span></span>).<li>Choice of activation functions (their form, not their values).</ul></ul><h2 id=comments tabindex=-1>Comments <a href=#comments class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><mark>Always use vectorized</mark> if possible! Especially for number of examples!<li>We can't use vectorized for number of layers, we need <code>for</code>.<li>Sometimes, functions computed with <strong>Deep NN</strong> (more layers, fewer nodes in each layer) is better than <strong>Shallow</strong> (fewer layers, more nodes). E.g. function <code>XOR</code>.<li>Deeper layer in the network, more complex features to be determined!<li><mark>Applied deep learning is a very empirical process!</mark> Best values depend much on data, algorithms, hyperparameters, CPU, GPU,...<li>Learning algorithm works sometimes from data, not from your thousands line of codes (surprise!!!)</ul><h2 id=application%3A-recognize-a-cat tabindex=-1>Application: recognize a cat <a href=#application%3A-recognize-a-cat class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><p>This section contains an idea, not a <a href=https://github.com/dinhanhthi/deeplearning-coursera-solutions/blob/master/course-1/week-4/Deep%2BNeural%2BNetwork%2B-%2BApplication%2Bv8.ipynb>complete task</a>!<div class=columns-2 markdown=1><p><img alt="Image to vector conversion." class="img-95 pop" src=/img/post/mooc/dl/imvectorkiank.png><br><em>Image to vector conversion. Image from the course.</em><p><img alt="L-layer deep neural network" class="img-95 pop" src=/img/post/mooc/dl/l-layer-dnn.png><br><em>L-layer deep neural network. Image from the course.</em></div><h2 id=python-tips tabindex=-1>Python tips <a href=#python-tips class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><p>○ Reshape quickly from <code>(10,9,9,3)</code> to <code>(9*9*3,10)</code>:<pre class=language-python><code class=language-python>X <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><br>X <span class="token operator">=</span> X<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T</code></pre><p>○ Don't use loop, use <strong>vectorization</strong>!</div><script type=application/ld+json>{
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "DL 1 - NN and DL",
        "image": [],
        "author": "Anh-Thi DINH",
        "url": "https://dinhanhthi.com/deeplearning-ai-course-1/",
        "mainEntityOfPage": "https://dinhanhthi.com/deeplearning-ai-course-1/",
        "datePublished": "04-04-2020",
        "dateModified": "2020-04-04",
        "description": "This is my note for the course (Neural Networks and Deep Learning). The codes in this note are rewritten to be more clear and concise. 👉..."
      }</script></article></main><footer><a href=/ target=_blank>Thi  ©  2022 </a> •  <a href=/about-the-notes/ >About this site </a> •  <a href=https://photos.app.goo.gl/9OVEkdTjmtRPg7vC3 target=_blank>My sketches </a> •  <a href=https://goo.gl/photos/yQXdQws1LLS16x5v5 target=_blank>I cook </a> •  <a href=/support-thi/ ><img alt="Support Thi" class=keep-original src=/img_src/icons/coffee.svg height=16 width=auto> Support Thi</a></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js></script><script src=/src/js/components/clipboard.min.js></script><script src="/src/js/main.min.js?hash=d3b51a19b7" defer async></script><a href=/support-thi/ class="floating-button tooltip" id=buy-me-a-coffee><img alt="Support Thi" class=keep-original src=/img_src/icons/coffee.svg> <span class=tooltiptext>Support Thi</span> </a><button class="floating-button tooltip" id=scroll-top-btn><img alt="Scroll to top" class=keep-original src=/img_src/to-top.webp> <span class=tooltiptext>Top</span></button>