<!doctype html><html domain=.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="" http-equiv=Content-Security-Policy><link href=/favicon.svg rel=icon type=image/svg+xml><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>Docker 101 | Note of Thi</title><meta content="Docker 101 | Note of Thi" prefix=og:http://ogp.me/ns# property=og:title><meta content="ðŸ‘‰ Note: Docker + GPUs ðŸ‘‰ Note: Wordpress Docker ðŸ‘‰ Note: Airflow + Kubernetes 101 ðŸ‘‰ Note: Tensorflow extra What and Why? Intuitive images..." name=description><meta content="ðŸ‘‰ Note: Docker + GPUs ðŸ‘‰ Note: Wordpress Docker ðŸ‘‰ Note: Airflow + Kubernetes 101 ðŸ‘‰ Note: Tensorflow extra What and Why? Intuitive images..." prefix=og:http://ogp.me/ns# property=og:description><meta content=summary_large_image name=twitter:card><meta content=@dinhanhthi name=twitter:site><meta content=@dinhanhthi name=twitter:creator><meta content=https://dinhanhthi.com/img_src/cover.png prefix=og:http://ogp.me/ns# property=og:image><meta content=article prefix=og:http://ogp.me/ns# property=og:type><link href=https://dinhanhthi.com/docker/ rel=canonical><meta content=https://dinhanhthi.com/docker/ prefix=og:http://ogp.me/ns# property=og:url><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="ðŸ”¥ Anh-Thi DINH"><link href=/ rel=preconnect crossorigin><style>body {
      visibility: hidden;
      opacity: 0;
    }</style><noscript><style>body {
        visibility: visible;
        opacity: 1;
      }</style></noscript><script csp-hash>if (/Mac OS X/.test(navigator.userAgent))
      document
        .documentElement
        .classList
        .add('apple')</script><link href=/src/css/main.css rel=stylesheet type=text/css><style>@font-face{font-display:swap;font-family:'fontello';src:url(/fontello/font/fontello.eot?46432155);src:url(/fontello/font/fontello.eot?46432155#iefix) format('embedded-opentype'),url(/fontello/font/fontello.woff2?46432155) format('woff2'),url(/fontello/font/fontello.woff?46432155) format('woff'),url(/fontello/font/fontello.ttf?46432155) format('truetype'),url(/fontello/font/fontello.svg?46432155#fontello) format('svg');font-weight:400;font-style:normal}[class*=" icon-"]:before,[class^=icon-]:before{font-family:"fontello";font-style:normal;font-weight:400;speak:never;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-doc:before{content:'\e800'}.icon-doc-add:before{content:'\e801'}.icon-stats:before{content:'\e802'}.icon-tags:before{content:'\e803'}.icon-like:before{content:'\e804'}.icon-cog-alt:before{content:'\e805'}.icon-project:before{content:'\e806'}.icon-mooc:before{content:'\e807'}.icon-dl:before{content:'\e808'}.icon-ml:before{content:'\e809'}.icon-python:before{content:'\e80a'}.icon-nlp:before{content:'\e80b'}.icon-r-lang:before{content:'\e80c'}.icon-skill:before{content:'\e80d'}.icon-js-solid:before{content:'\e80e'}.icon-game:before{content:'\e80f'}.icon-web:before{content:'\e810'}.icon-algo:before{content:'\e811'}.icon-mooc-solid:before{content:'\e812'}.icon-chatbot:before{content:'\e813'}.icon-web-dev:before{content:'\e814'}.icon-data:before{content:'\e815'}.icon-skill-solid:before{content:'\e816'}.icon-python-solid:before{content:'\e817'}.icon-project-solid:before{content:'\e818'}.icon-js:before{content:'\e819'}.icon-rocket:before{content:'\e81a'}.icon-ml-solid:before{content:'\e81b'}.icon-game-solid:before{content:'\e81c'}.icon-dl-solid:before{content:'\e81d'}.icon-nlp-solid:before{content:'\e81e'}.icon-web-solid:before{content:'\e81f'}.icon-algo-solid:before{content:'\e820'}.icon-puzzle-outline:before{content:'\e821'}.icon-ng:before{content:'\e822'}.icon-ok:before{content:'\e823'}.icon-link:before{content:'\e824'}.icon-down-circle:before{content:'\e826'}.icon-api:before{content:'\e828'}.icon-right-circle:before{content:'\e829'}.icon-down-open:before{content:'\e82a'}.icon-right-open:before{content:'\e82b'}.icon-copy:before{content:'\f0c5'}.icon-gamepad:before{content:'\f11b'}.icon-fork:before{content:'\f126'}.icon-mlops-solid:before{content:'\f135'}.icon-edu-solid:before{content:'\f19d'}.icon-others-solid:before{content:'\f1b3'}.icon-ds-solid:before{content:'\f1c0'}.icon-chart-area:before{content:'\f1fe'}.icon-chart-pie:before{content:'\f200'}.icon-ts:before{content:'\f201'}.icon-clone:before{content:'\f24d'}</style><body><script>function showTheme() {
        const btn = document.getElementById("toggle-dark-light");
        let toggleIcon = btn.firstElementChild;
        const currentTheme = localStorage.getItem("theme");
        if (currentTheme === "dark") {
          document
            .body
            .classList
            .toggle("dark-theme");
          toggleIcon.src = "/img_src/nav/sun.svg";
        } else if (currentTheme === "light") {
          document
            .body
            .classList
            .toggle("light-theme");
          toggleIcon.src = "/img_src/nav/moon.svg";
        }
      }
      function showContent() {
        document.body.style.visibility = 'visible';
        document.body.style.opacity = 1;
      }
      window.addEventListener('DOMContentLoaded', (event) => {
        showTheme();
        showContent();
      });</script><header class="wave-border wave-border-post"><nav><div id=nav><a href=/ class="nav-item no-effect"><img alt=home class=keep-original src=/img_src/nav/home.svg height=18 width=18> <span>Thi</span> </a><a href=/about/ class="nav-item no-effect"><img alt=about class=keep-original src=/img_src/nav/about.svg height=15 width=15> <span>About</span></a><div class=nav-search id=nav-search><form><input aria-label='search notes (press "/" to focus & "ESC" to lose)' autocomplete=off class=nav-search__input id=nav-search__input onfocusin=inFocus(this) placeholder='search notes (press "/" to focus & "ESC" to lose)' type=search></form><div id=nav-search__result-container style="display: none;"><ul id=nav-search__ul></ul><div id=nav-search__no-result style="display: none;"><p>No results found.</div></div></div><span class="nav-item no-effect nav-dark-light" href="" id=toggle-dark-light><img alt=light-mode class=keep-original src=/img_src/nav/moon.svg height=20 width=20> </span><a href=https://github.com/dinhanhthi class="nav-item no-effect nav-github" target=_blank><img alt=github class=keep-original src=/img_src/nav/github.svg height=20 width=20></a></div><div class=reading-progress-container><div id=reading-progress aria-hidden=true></div></div></nav><script>var divNavSearch=document.getElementById("nav-search"),divRes=document.getElementById("nav-search__result-container"),ulRes=document.getElementById("nav-search__ul");function inFocus(e){""!=e.value&&(divRes.style.display="block")}var isOnDiv=!1;divRes.addEventListener("mouseover",(function(){isOnDiv=!0})),divRes.addEventListener("mouseout",(function(){isOnDiv=!1}));var inputSearch=document.getElementById("nav-search__input");window.addEventListener("click",(function(){ulRes.getElementsByTagName("li").length>=1&&isOnDiv||(divRes.style.display="none")})),inputSearch.addEventListener("click",(e=>{e.stopPropagation()}));const addSelected=e=>{ulRes.querySelectorAll("li").forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected")};var isInView=(e,t)=>{var n=e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight;return e.offsetTop<t.scrollTop?"above":n?"below":"in"};const updateScroll=(e,t)=>{e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight&&(t.scrollTop=e.offsetTop+e.offsetHeight-t.offsetHeight),e.offsetTop<t.scrollTop&&(t.scrollTop=e.offsetTop)};document.onkeydown=e=>{checkInInput=document.activeElement==inputSearch,"/"!==e.key||checkInInput||(e.stopPropagation(),e.preventDefault(),inputSearch.focus())},document.addEventListener("focusin",(e=>{divNavSearch.contains(e.target)||(divRes.style.display="none")})),inputSearch.onkeydown=e=>{if("Enter"===e.key){e.stopPropagation(),e.preventDefault();var t=ulRes.querySelector('li[class*="selected"]');window.location.href=t.getElementsByClassName("item__content")[0].firstChild.firstChild.href}"Escape"===e.key&&(divRes.style.display="none",inputSearch.blur())},divNavSearch.onkeydown=e=>{if(hasResult=ulRes.getElementsByTagName("li").length>=1,hasResult){["ArrowUp","ArrowDown"].indexOf(e.key)>-1&&e.preventDefault();var t=ulRes.firstChild,n=ulRes.lastChild,s=ulRes.querySelector('li[class*="selected"]');switch(e.key){case"ArrowUp":nextLi=s&&s!=t?s.previousSibling:n,addSelected(nextLi),s=nextLi,updateScroll(s,divRes);break;case"ArrowDown":nextLi=s&&s!=n?s.nextSibling:t,addSelected(nextLi),s=nextLi,updateScroll(s,divRes)}}};</script><div class=header-container><div class="header-logo post-layout"><img alt="Docker 101" class=keep-original src=/img/header/docker.svg height=55 width=55></div><h1>Docker 101</h1><div id=more-info><div id=note-tag><a href=/tags/mlops/ id=category }>MLOps</a> <a href=/tags/docker/ id=category }>Docker</a></div><div id=last-modified>Last modified 22 days ago / <a href=https://github.com/dinhanhthi/notes/edit/master/./posts/mlops/2020-03-09-docker.md>Edit on Github</a></div></div></div></header><main class="" id=main-wrapper><article class=post-container><div class="container mt-2 normal page-note"><div class="toc toc-common toc-js"><div class=ol-container><div class=toc-heading>In this note</div><ol><li><a href=#what-and-why%3F>What and Why?</a><li><a href=#abbreviate>Abbreviate</a><li><a href=#installation>Installation</a><li><a href=#uninstall>Uninstall</a><ol><li><a href=#linux>Linux</a></ol><li><a href=#login-%26-download-images>Login & Download images</a><li><a href=#check-info>Check info</a><ol><li><a href=#images>Images</a><li><a href=#containers>Containers</a><li><a href=#others>Others</a></ol><li><a href=#attach-%2F-start-%2F-stop>Attach / Start / Stop</a><li><a href=#delete>Delete</a><ol><li><a href=#everything>Everything</a><li><a href=#images-1>Images</a><li><a href=#containers-1>Containers</a></ol><li><a href=#build-an-image>Build an image</a><ol><li><a href=#create>Create</a><li><a href=#dockerfile>Dockerfile</a></ol><li><a href=#create-a-container>Create a container</a><ol><li><a href=#cli>CLI</a><li><a href=#docker-compose.yml>docker-compose.yml</a></ol><li><a href=#errors>Errors</a><li><a href=#reference>Reference</a></ol></div></div><p>ðŸ‘‰ Note: <a href=/docker-gpu/ >Docker + GPUs</a><br>ðŸ‘‰ Note: <a href=/wordpress-docker/ >Wordpress Docker</a><br>ðŸ‘‰ Note: <a href=/airflow-k8s-101/ >Airflow + Kubernetes 101</a><br>ðŸ‘‰ Note: <a href=/tensorflow/ >Tensorflow extra</a><h2 id=what-and-why%3F tabindex=-1>What and Why? <a href=#what-and-why%3F class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><div class=hsbox><div class=hs__title>Intuitive images</div><div class=hs__content><p><img alt="What's docker" class=img-80 src=/img/post/deploy/docker/docker.png><br><em>Souce <a href=https://rollout.io/blog/is-docker-secure/ >rollout.io</a>.</em><p><img alt="Container  vs Virtual Machine" class=img-100 src=/img/post/deploy/docker/vm-vs-docker.png><br><em>Container vs Virtual Machine, souce <a href=https://www.docker.com/resources/what-container>docker.com</a>.</em><p><img alt="RAM usage: Docker  vs Virtual Machine" class=img-80 src=/img/post/deploy/docker/ram_docker_vm.jpg><br><em>RAM usage: Docker vs Virtual Machine, souce <a href=https://www.edureka.co/blog/what-is-docker-container>eureka.com</a>.</em></div></div><h2 id=abbreviate tabindex=-1>Abbreviate <a href=#abbreviate class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><div class=two-columns-list><ul><li><code>ps</code> = process status : check running containers (with <code>-a</code> for all)<li><code>-i</code> = interactive : used in <code>docker exec</code> or <code>docker run</code><li><code>-t</code> = terminal : used in <code>docker exec</code> or <code>docker run</code><li><code>-m</code> = memory<li><code>-v</code> or <code>--volume</code> : corresponding folders in/out containers.<li><code>--rm</code> : create temprarily a container (removed after exit)</ul></div><h2 id=installation tabindex=-1>Installation <a href=#installation class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><div class=success><p>ðŸ‘‰ For all platforms, check <a href=https://docs.docker.com/get-docker/ >official guide</a>. <strong>It's up to date!</strong></div><ul><li>You mind find <a href=https://devimalplanet.com/how-to-install-docker-on-linux-pop-os>this article</a> is useful for Ubuntu/Pop!_OS.<li>After installing, if you meet <code>Got permission denied while trying to connect to the Docker daemon socket</code>, check <a href=https://www.digitalocean.com/community/questions/how-to-fix-docker-got-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket>this</a>.</ul><div class=hsbox><div class=hs__title><strong>Linux</strong></div><div class=hs__content><ul><li><p>For Linux, check <a href=https://docs.docker.com/engine/install/ >this</a>!<div class=hsbox><div class=hs__title>Show codes</div><div class=hs__content><p>Unninstall old versions<pre class=language-bash><code class=language-bash><span class="token function">sudo</span> <span class="token function">apt-get</span> remove <span class="token function">docker</span> docker-engine docker.io containerd runc<br><span class="token function">sudo</span> <span class="token function">apt-get</span> update<br><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token punctuation">\</span><br>    apt-transport-https <span class="token punctuation">\</span><br>    ca-certificates <span class="token punctuation">\</span><br>    <span class="token function">curl</span> <span class="token punctuation">\</span><br>    gnupg-agent <span class="token punctuation">\</span><br>    software-properties-common<br><span class="token function">curl</span> -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -</code></pre><p>Make sure: <code>9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88</code><pre class=language-bash><code class=language-bash><span class="token function">sudo</span> apt-key fingerprint 0EBFCD88<br><span class="token function">sudo</span> add-apt-repository <span class="token punctuation">\</span><br>  <span class="token string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu \<br>  <span class="token variable"><span class="token variable">$(</span>lsb_release -cs<span class="token variable">)</span></span> \<br>  stable"</span></code></pre><p>Install docker engine<pre class=language-bash><code class=language-bash><span class="token function">sudo</span> <span class="token function">apt-get</span> update<br><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> docker-ce docker-ce-cli containerd.io</code></pre><p>Check if everything is ok<pre class=language-bash><code class=language-bash><span class="token function">sudo</span> <span class="token function">docker</span> run hello-world</code></pre><p>Incase docker-compose isn't installed<pre class=language-bash><code class=language-bash><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">docker-compose</span></code></pre></div></div><p>If you use Ubuntu 20.04+, replace <code>$(lsb_release -cs)</code> with <code>eoan</code> because docker currently (17 May 20) doesn't support 20.04 yet!<li><p>If wanna run docker without <code>root</code>, check <a href=https://docs.docker.com/engine/install/linux-postinstall/ >this</a>.<pre class=language-bash><code class=language-bash><span class="token function">sudo</span> <span class="token function">groupadd</span> <span class="token function">docker</span> <span class="token comment"># create a docker group</span><br><span class="token function">sudo</span> <span class="token function">usermod</span> -aG <span class="token function">docker</span> <span class="token operator">&lt;</span>user<span class="token operator">></span> <span class="token comment"># add &lt;user> to group</span><br>newgrp <span class="token function">docker</span> <span class="token comment"># activate the changes</span></code></pre><li><p>Configure docker start on boot (Ubuntu 15.04 or later)<pre class=language-bash><code class=language-bash><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span></code></pre></ul></div></div><div class=hsbox><div class=hs__title><strong>MacOS</strong></div><div class=hs__content><p>ðŸ‘‰ Check <a href=https://docs.docker.com/docker-for-mac/install/ >this</a>.</div></div><div class=hsbox><div class=hs__title><strong>Windows</strong></div><div class=hs__content><p>ðŸ‘‰ Note: <a href=/docker-wsl2-windows/#docker-%2B-gpu-%2B-wsl>Docker + WSL2</a><div class=hsbox><div class=hs__title>Check the requirements</div><div class=hs__content><p>You must have Windows 10: Pro, Enterprise, or Education (Build 15063 or later). Check <a href=https://docs.docker.com/docker-for-windows/install/#what-to-know-before-you-install>other requirements</a>.<pre class=language-bash><code class=language-bash><span class="token comment"># POWERSHELL</span><br><span class="token comment"># check window version</span><br>Get-WmiObject -Class Win32_OperatingSystem <span class="token operator">|</span> % Caption<br><span class="token comment"># check window build number</span><br>Get-WmiObject -Class Win32_OperatingSystem <span class="token operator">|</span> % Buildnumber</code></pre><p>Active <strong>Hyper-V</strong> and <strong>Containers</strong> (you can do it manually in <strong>Turn Windows features on or off</strong>)<pre class=language-bash><code class=language-bash><span class="token comment"># Open PowerShell with Administrator and run following</span><br>Enable-WindowsOptionalFeature -Online -FeatureName containers â€“All<br>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V â€“All<br><span class="token comment"># restart</span></code></pre></div></div><ol><li><a href=https://docs.docker.com/docker-for-windows/install/ >Download</a> and install.<li>Check <code>docker version</code>.<li>Try <code>docker run hello-world</code>.</ol></div></div><div class=hsbox><div class=hs__title>With GPUs support?</div><div class=hs__content><p>Check <a href=/docker-gpu>this note</a>.</div></div><h2 id=uninstall tabindex=-1>Uninstall <a href=#uninstall class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><h3 id=linux tabindex=-1>Linux <a href=#linux class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><pre class=language-bash><code class=language-bash><span class="token comment"># from docker official</span><br><span class="token function">sudo</span> <span class="token function">apt-get</span> remove <span class="token function">docker</span> docker-engine docker.io containerd runc</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># identify what installed package you have</span><br>dpkg -l <span class="token operator">|</span> <span class="token function">grep</span> -i <span class="token function">docker</span><br><br><span class="token comment"># uninstall</span><br><span class="token function">sudo</span> <span class="token function">apt-get</span> purge -y docker-engine <span class="token function">docker</span> docker.io docker-ce docker-ce-cli<br><span class="token function">sudo</span> <span class="token function">apt-get</span> autoremove -y --purge docker-engine <span class="token function">docker</span> docker.io docker-ce</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># remove images containers</span><br><span class="token function">sudo</span> <span class="token function">rm</span> -rf /var/lib/docker /etc/docker<br><span class="token function">sudo</span> <span class="token function">rm</span> /etc/apparmor.d/docker<br><span class="token function">sudo</span> <span class="token function">groupdel</span> <span class="token function">docker</span><br><span class="token function">sudo</span> <span class="token function">rm</span> -rf /var/run/docker.sock</code></pre><h2 id=login-%26-download-images tabindex=-1>Login & Download images <a href=#login-%26-download-images class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><pre class=language-bash><code class=language-bash><span class="token function">docker</span> login<br><span class="token comment"># using username (not email) and password</span></code></pre><p class=noindent><ul><li>Download at <a href=https://hub.docker.com/ >Docker Hub</a>.<li>Download images are store at <code>C:\ProgramData\DockerDesktop\vm-data</code> (Windows) by default.</ul><h2 id=check-info tabindex=-1>Check info <a href=#check-info class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><pre class=language-bash><code class=language-bash><span class="token comment"># docker's version</span><br><span class="token function">docker</span> --version</code></pre><h3 id=images tabindex=-1>Images <a href=#images class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># list images on the host</span><br><span class="token function">docker</span> images</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># check image's info</span><br><span class="token function">docker</span> inspec <span class="token operator">&lt;</span>image_id<span class="token operator">></span></code></pre></div><h3 id=containers tabindex=-1>Containers <a href=#containers class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># list running containers</span><br><span class="token function">docker</span> <span class="token function">ps</span><br><span class="token function">docker</span> <span class="token function">ps</span> -a <span class="token comment"># all (including stopped)</span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># only the ids</span><br><span class="token function">docker</span> <span class="token function">ps</span> -q<br><span class="token function">docker</span> <span class="token function">ps</span> -a -q</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># container's size</span><br><span class="token function">docker</span> <span class="token function">ps</span> -s<br><span class="token function">docker</span> <span class="token function">ps</span> -a -s</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># container's names only</span><br><span class="token function">docker</span> <span class="token function">ps</span> --format <span class="token string">'{{.Names}}'</span><br><span class="token function">docker</span> <span class="token function">ps</span> -a --format <span class="token string">'{{.Names}}'</span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># Check the last command in container</span><br><span class="token function">docker</span> <span class="token function">ps</span> --format <span class="token string">'{{.Command}}'</span> --no-trunc</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># check log</span><br><span class="token comment"># useful if we wanna see the last running tasks's</span><br><span class="token function">docker</span> container logs <span class="token operator">&lt;</span>container_name<span class="token operator">></span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># get ip address</span><br><span class="token function">docker</span> inspect <span class="token operator">&lt;</span>container_name<span class="token operator">></span> <span class="token operator">|</span> <span class="token function">grep</span> IPAddress</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># Attach to the running container</span><br><span class="token function">docker</span> attach <span class="token operator">&lt;</span>container_name<span class="token operator">></span></code></pre></div><h3 id=others tabindex=-1>Others <a href=#others class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># RAM & CPU usages</span><br><span class="token function">docker</span> stats<br><span class="token function">docker</span> stats <span class="token operator">&lt;</span>container_name<span class="token operator">></span></code></pre></div><h2 id=attach-%2F-start-%2F-stop tabindex=-1>Attach / Start / Stop <a href=#attach-%2F-start-%2F-stop class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><p>We can use sometimes interchangeable between <code>&lt;container_id></code> and <code>&lt;container_name></code>.<div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># get info (container's id, image's id first)</span><br><span class="token function">docker</span> <span class="token function">ps</span> -a</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># start a stopped container</span><br><span class="token function">docker</span> start <span class="token operator">&lt;</span>container_id<span class="token operator">></span><br><br><span class="token comment"># start and enter the container</span><br><span class="token function">docker</span> start -i <span class="token operator">&lt;</span>container<span class="token operator">></span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># stop a container</span><br><span class="token function">docker</span> stop <span class="token operator">&lt;</span>container_id<span class="token operator">></span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># Entering the running container (not attach)</span><br><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it <span class="token operator">&lt;</span>container_name<span class="token operator">></span> <span class="token function">bash</span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># stop all running containers</span><br><span class="token function">docker</span> stop <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> -a -q<span class="token variable">)</span></span></code></pre></div><h2 id=delete tabindex=-1>Delete <a href=#delete class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><p>Read more <a href=https://www.digitalocean.com/community/tutorials/how-to-remove-docker-images-containers-and-volumes>here</a>.<h3 id=everything tabindex=-1>Everything <a href=#everything class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># any resources</span><br><span class="token function">docker</span> system prune</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># with all unused images</span><br><span class="token function">docker</span> system prune -a</code></pre></div><h3 id=images-1 tabindex=-1>Images <a href=#images-1 class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># list all images</span><br><span class="token function">docker</span> images -a</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># remove a specific image</span><br><span class="token function">docker</span> image <span class="token function">rm</span> <span class="token operator">&lt;</span>IMAGE_ID<span class="token operator">></span></code></pre></div><p><strong>Dangling images</strong> are layers that have no relationship to any tagged images.<div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># list dangling images</span><br><span class="token function">docker</span> images -f <span class="token variable assign-left">dangling</span><span class="token operator">=</span>true</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># remove dangling images</span><br><span class="token function">docker</span> images purge</code></pre></div><h3 id=containers-1 tabindex=-1>Containers <a href=#containers-1 class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># remove a specific containers</span><br><span class="token function">docker</span> <span class="token function">rm</span> -f <span class="token operator">&lt;</span>container-id<span class="token operator">></span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># remove all containers</span><br><span class="token function">docker</span> <span class="token function">rm</span> -f <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> -a -q<span class="token variable">)</span></span></code></pre></div><h2 id=build-an-image tabindex=-1>Build an image <a href=#build-an-image class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><h3 id=create tabindex=-1>Create <a href=#create class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><div class=col-2-equal><pre class=language-bash><code class=language-bash><span class="token comment"># build image with Dockerfile</span><br><span class="token function">docker</span> build -t <span class="token operator">&lt;</span>img_name<span class="token operator">></span> <span class="token builtin class-name">.</span><br><br><span class="token comment"># custom Dockerfile.abc</span><br><span class="token function">docker</span> build -t <span class="token operator">&lt;</span>img_name<span class="token operator">></span> <span class="token builtin class-name">.</span> -f Dockerfile.abc</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># with docker-compose</span><br><span class="token function">docker-compose</span> up<br><span class="token comment"># with custom file</span><br><span class="token function">docker-compose</span> -f docker-compose.amin.yml up -d</code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># if success</span><br><span class="token comment"># service name "docker_thi"</span><br><span class="token function">docker</span> run -it <span class="token operator">&lt;</span>service_name<span class="token operator">></span> <span class="token function">bash</span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># from current container</span><br><span class="token function">docker</span> <span class="token function">ps</span> -a <span class="token comment"># check all containers</span><br><span class="token function">docker</span> commit <span class="token operator">&lt;</span>container_id<span class="token operator">></span> <span class="token operator">&lt;</span>new_image_name<span class="token operator">></span></code></pre></div><h3 id=dockerfile tabindex=-1><code>Dockerfile</code> <a href=#dockerfile class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><p>ðŸ‘‰ <strong>Official doc</strong>: <a href=https://docs.docker.com/develop/develop-images/dockerfile_best-practices/ >Best practices for writing Dockerfiles</a><div class=hsbox><div class=hs__title>An example</div><div class=hs__content><pre class=language-bash><code class=language-bash>FROM nvidia/cuda:10.2-base<br><br><span class="token comment"># encoding</span><br>ENV <span class="token constant environment">LANG</span> en_US.UTF-8<br>ENV <span class="token constant environment">LANGUAGE</span> en_US:en<br>ENV <span class="token constant environment">LC_ALL</span> en_US.UTF-8<br><br><span class="token comment"># fix (tzdatachoose)</span><br>ARG <span class="token variable assign-left">DEBIAN_FRONTEND</span><span class="token operator">=</span>noninteractive<br><br>RUN <span class="token function">apt-get</span> -y update <span class="token operator">&&</span> <span class="token punctuation">\</span><br>    <span class="token function">apt-get</span> -y upgrade <span class="token operator">&&</span> <span class="token punctuation">\</span><br>    <span class="token function">apt-get</span> <span class="token function">install</span> -y openssh-server <span class="token operator">&&</span> <span class="token punctuation">\</span><br>    <span class="token function">apt-get</span> <span class="token function">install</span> -y python3-pip python3-dev locales <span class="token function">git</span> r-base<br><br><span class="token comment"># ssh server</span><br>RUN <span class="token function">mkdir</span> /var/run/sshd<br>RUN <span class="token builtin class-name">echo</span> <span class="token string">'root:qwerty'</span> <span class="token operator">|</span> chpasswd<br>RUN <span class="token function">sed</span> -i <span class="token string">'s/#PermitRootLogin prohibit-password/PermitRootLogin yes/'</span> /etc/ssh/sshd_config<br><span class="token comment"># SSH login fix. Otherwise user is kicked off after login</span><br>RUN <span class="token function">sed</span> <span class="token string">'s@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g'</span> -i /etc/pam.d/sshd<br><span class="token comment"># need?</span><br>ENV NOTVISIBLE <span class="token string">"in users profile"</span><br>RUN <span class="token builtin class-name">echo</span> <span class="token string">"export VISIBLE=now"</span> <span class="token operator">>></span> /etc/profile<br><br><span class="token comment"># create alias</span><br>RUN <span class="token builtin class-name">echo</span> <span class="token string">'alias python="python3"'</span> <span class="token operator">>></span> ~/.bashrc<br>RUN <span class="token builtin class-name">echo</span> <span class="token string">'alias pip="pip3"'</span> <span class="token operator">>></span> ~/.bashrc<br><br><span class="token comment"># create shortcuts</span><br>RUN <span class="token function">ln</span> -s /abc/xyz /xyz/xyz<br><br><span class="token comment"># install python's requirements</span><br>COPY requirements_dc.txt requirements.txt<br>RUN python3 -m pip <span class="token function">install</span> --upgrade pip <span class="token operator">&&</span> <span class="token punctuation">\</span><br>    python3 -m pip <span class="token function">install</span> -r requirements.txt<br>COPY <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span><br><br><span class="token comment"># export port ssh</span><br>EXPOSE <span class="token number">22</span><br><br>COPY script.sh starting_script.sh<br><span class="token comment"># run</span><br>CMD <span class="token punctuation">[</span><span class="token string">"sh"</span>,<span class="token string">"-c"</span>,<span class="token string">"cd /data_controller/utils/ && sh generate_grpc_code_from_protos.sh && cd /srv/ && sh starting_script.sh"</span><span class="token punctuation">]</span></code></pre></div></div><div class=hsbox><div class=hs__title>Connect to container via ssh</div><div class=hs__content><pre class=language-bash><code class=language-bash>FROM ubuntu:20.04<br><br>RUN <span class="token function">apt-get</span> update <span class="token operator">&&</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y openssh-server<br>RUN <span class="token function">mkdir</span> /var/run/sshd<br>RUN <span class="token builtin class-name">echo</span> <span class="token string">'root:THEPASSWORDYOUCREATED'</span> <span class="token operator">|</span> chpasswd<br>RUN <span class="token function">sed</span> -i <span class="token string">'s/#*PermitRootLogin prohibit-password/PermitRootLogin yes/g'</span> /etc/ssh/sshd_config<br><br><span class="token comment"># SSH login fix. Otherwise user is kicked off after login</span><br>RUN <span class="token function">sed</span> -i <span class="token string">'s@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g'</span> /etc/pam.d/sshd<br><br>ENV NOTVISIBLE <span class="token string">"in users profile"</span><br>RUN <span class="token builtin class-name">echo</span> <span class="token string">"export VISIBLE=now"</span> <span class="token operator">>></span> /etc/profile<br><br>EXPOSE <span class="token number">22</span><br>CMD <span class="token punctuation">[</span><span class="token string">"/usr/sbin/sshd"</span>, <span class="token string">"-D"</span><span class="token punctuation">]</span></code></pre><p>For more about ssh connection, check <a href=https://docs.docker.com/engine/examples/running_ssh_service/ >official doc</a>.<p>If <code>.env</code> doesn't work? => This is expected. SSH wipes out the environment as part of the login process. <sup><a href=https://github.com/moby/moby/issues/2569#issuecomment-27973910 target=_blank rel="noopener noreferrer">[ref]</a></sup><pre class=language-bash><code class=language-bash><span class="token comment"># For example, all environement variables are stored in a</span><br><span class="token comment"># /home/thi/.env</span><br><br><span class="token comment"># add them to container's env</span><br><span class="token function">cat</span> /home/thi/.env <span class="token operator">>></span> /etc/environment<br><br><span class="token comment"># exit current ssh session</span><br><span class="token comment"># connect again</span><br><br><span class="token comment"># check</span><br><span class="token function">env</span></code></pre><p>More references: <a href=https://askubuntu.com/questions/58814/how-do-i-add-environment-variables>here</a> and <a href=https://stackoverflow.com/questions/34630571/docker-env-variables-not-set-while-log-via-shell>here</a>.</div></div><div class=hsbox><div class=hs__title>Meaning of terms</div><div class=hs__content><ul><li><p><code>FROM</code>: the base image you use, can be obtained from <a href=https://hub.docker.com/ >Docker Hub</a>. For example, <code>FROM ubuntu:18.04</code> (<code>18.04</code> is a tag, <code>latest</code> is default)<li><p><code>WORKDIR app/</code>: Use <code>app/</code> as the working directory.<li><p><code>RUN</code>: install your application and packages requited, e.g. <code>RUN apt-get -y update</code>.<ul><li><code>RUN &lt;command></code> (shell form)<ul><li><code>RUN ["executable", "param1", "param2"]</code> (exec form)</ul></ul><li><p><code>CMD</code>: sets default command and/or parameters, which can be overwritten if docker container runs with command lines. If there are many <code>CMD</code>s, the last will be used.<pre class=language-bash><code class=language-bash><span class="token comment"># in Dockerfile</span><br>CMD <span class="token builtin class-name">echo</span> <span class="token string">"Hello world"</span><br><span class="token comment"># run only</span><br><span class="token function">docker</span> run -it <span class="token operator">&lt;</span>image<span class="token operator">></span><br><span class="token comment"># output: "Hello world"</span><br><br><span class="token comment"># run with a command line</span><br><span class="token function">docker</span> run -it <span class="token operator">&lt;</span>image<span class="token operator">></span> /bin/bash<br><span class="token comment"># output (CMD ignored, bash run instead): root@7de4bed89922:/#</span></code></pre><ul><li><code>CMD ["executable","param1","param2"]</code> (exec form, preferred)<li><code>CMD ["param1","param2"]</code> (sets additional default parameters for <code>ENTRYPOINT</code> in exec form)<li><code>CMD command param1 param2</code> (shell form)<li>Multiple commands: <code>CMD ["sh","-c","mkdir abc && cd abc && touch new.file"]</code></ul><li><p><code>ENTRYPOINT</code>: configures a container that will run as an executable. Look like <code>CMD</code> but <code>ENTRYPOINT</code> commands and parameters are not ignored when Docker container runs with command line parameters.<div class=hsbox><div class=hs__title>More detail</div><div class=hs__content><pre class=language-bash><code class=language-bash><span class="token comment"># Dockerfile</span><br>ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"/bin/echo"</span>, <span class="token string">"Hello"</span><span class="token punctuation">]</span><br>CMD <span class="token punctuation">[</span><span class="token string">"world"</span><span class="token punctuation">]</span><br><span class="token comment"># run</span><br><span class="token function">docker</span> run -it <span class="token operator">&lt;</span>image<span class="token operator">></span><br><span class="token comment"># produces 'Hello world'</span><br><br><span class="token comment"># but run</span><br><span class="token function">docker</span> run -it <span class="token operator">&lt;</span>image<span class="token operator">></span> John<br><span class="token comment"># produces 'Hello John' (only CMD command is override)</span></code></pre></div></div><ul><li><code>ENTRYPOINT ["executable", "param1", "param2"]</code> (exec form, preferred)<li><code>ENTRYPOINT command param1 param2</code> (shell form)</ul><li><p><code>EXPOSE 5000</code>: Listen on the specified port<li><p><code>COPY . app/</code>: Copy the files from the current directory to <code>app/</code></ul></div></div><div class=warning><p>(<a href=https://docs.docker.com/engine/reference/builder/#copy>ref</a>) You cannot use something like <code>COPY .. .</code> (parent of the folder containing the <code>Dockerfile</code>) in the <code>Dockerfile</code> because it uses the "build context" and it can access to files within that context.<div class=hsbox><div class=hs__title>Solution for above problem</div><div class=hs__content><p>In the Dockerfile, change <code>COPY .. .</code> to <code>COPY . .</code>.<p>Next, <code>cd ..</code> (go to the parent of the folder containing the Dockerfile, let's say <code>docker/</code>) and then use option <code>-f docker/Dockerfile</code> when you build an image.<p>Or you can use something below (no need to <code>cd ..</code>)<pre class=language-bash><code class=language-bash><span class="token function">docker</span> build -f <span class="token punctuation">..</span>/Dockerfile</code></pre></div></div></div><div class=hsbox><div class=hs__title>Example of run mutiple commands</div><div class=hs__content><p>If we run multiple interative commands (wait for action), for example, a jupyter notebook with a ssh server, we cannot put them directly in <code>CMD</code> command.<p><strong>Solution</strong>: using a file .sh and put <code>&</code> at the end of the 1st command like:<pre class=language-bash><code class=language-bash><span class="token variable"><span class="token variable">$(</span><span class="token function">which</span> sshd<span class="token variable">)</span></span> -Ddp <span class="token number">22</span> <span class="token operator">&</span><br><br>jupyter lab --no-browser --allow-root --ip<span class="token operator">=</span><span class="token number">0.0</span>.0.0 --NotebookApp.token<span class="token operator">=</span><span class="token string">''</span> --NotebookApp.password<span class="token operator">=</span><span class="token string">''</span></code></pre></div></div><h2 id=create-a-container tabindex=-1>Create a container <a href=#create-a-container class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><h3 id=cli tabindex=-1>CLI <a href=#cli class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><pre class=language-bash><code class=language-bash><span class="token comment"># container test from an image</span><br><span class="token function">docker</span> create --name container_test -t -i <span class="token operator">&lt;</span>image_id<span class="token operator">></span> <span class="token function">bash</span><br><span class="token function">docker</span> start container_test<br><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it container_test <span class="token function">bash</span></code></pre><pre class=language-bash><code class=language-bash><span class="token function">docker</span> run --name <span class="token operator">&lt;</span>container_name<span class="token operator">></span> -dp <span class="token number">3000</span>:3000 -v todo-db:/etc/todos <span class="token operator">&lt;</span>docker_img<span class="token operator">></span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># run a command in a running docker without entering to that container</span><br><span class="token comment"># e.g. running "/usr/sbin/sshd -Ddp 22"</span><br><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it -d docker_thi_dc /usr/sbin/sshd -Ddp <span class="token number">22</span><br><span class="token comment"># "-d" = Detached mode</span></code></pre><pre class=language-bash><code class=language-bash><span class="token comment"># want docker auto removes a container after exit</span><br><span class="token function">docker</span> run --rm <span class="token punctuation">..</span>.</code></pre><h3 id=docker-compose.yml tabindex=-1><code>docker-compose.yml</code> <a href=#docker-compose.yml class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><p>Use to create various services with the same image.<pre class=language-bash><code class=language-bash><span class="token function">docker-compose</span> up -d <span class="token comment"># up and detach</span><br><span class="token function">docker-compose</span> -f file_name.yml up -d <span class="token comment"># custom docker-compose.yml file name</span><br><br><span class="token comment"># if you run 2 container in the same folder name</span><br><span class="token function">docker-compose</span> -p <span class="token string">"project_1"</span> up -d<br><span class="token function">docker-compose</span> -p <span class="token string">"project_2"</span> up -d</code></pre><div class=hsbox><div class=hs__title>An example</div><div class=hs__content><pre class=language-bash><code class=language-bash><span class="token comment"># docker-compose.yml</span><br><span class="token comment">#------------------------------</span><br><br><span class="token comment"># run by `docker-compose up`</span><br>version: <span class="token string">'3'</span><br>services:<br>  dataswati:<br>    container_name: docker_thi<br>    image: docker_thi_img:latest<br>    ports:<br>      - <span class="token string">"8888:8888"</span><br>    volumes:<br>      - <span class="token string">"/local-folder/:/docker-folder/"</span><br>	working_dir: /srv</code></pre></div></div><div class=hsbox><div class=hs__title>Meaning of terms</div><div class=hs__content><ul><li><p><code>depends_on</code>:<sup><a href=https://docs.docker.com/compose/compose-file/#depends-on target=_blank rel="noopener noreferrer">[ref]</a></sup> Express dependency between services (with orders).<p>In <code>docker-compose.yml</code>: <code>db</code> and <code>redis</code> start before <code>web</code>.<pre class=language-yaml><code class=language-yaml><span class="token atrule key">version</span><span class="token punctuation">:</span> <span class="token string">"3.8"</span><br><span class="token atrule key">services</span><span class="token punctuation">:</span><br><span class="token atrule key">web</span><span class="token punctuation">:</span><br>	<span class="token atrule key">build</span><span class="token punctuation">:</span> .<br>	<span class="token atrule key">depends_on</span><span class="token punctuation">:</span><br>		<span class="token punctuation">-</span> db<br>		<span class="token punctuation">-</span> redis<br><span class="token atrule key">redis</span><span class="token punctuation">:</span><br>	<span class="token atrule key">image</span><span class="token punctuation">:</span> redis<br><span class="token atrule key">db</span><span class="token punctuation">:</span><br>	<span class="token atrule key">image</span><span class="token punctuation">:</span> postgres</code></pre><li><p><code>command</code>:<sup><a href=https://docs.docker.com/compose/compose-file/#command target=_blank rel="noopener noreferrer">[ref]</a></sup> Override the default command.<li><p><code>stdin_open: true</code> and <code>tty: true</code>: keep container alive!<li><p><code>volumes</code> (outside containers): volumes controlled by docker. They're located on different places,<pre class=language-bash><code class=language-bash><span class="token comment"># check info of a volume</span><br><span class="token function">docker</span> volume inspect <span class="token operator">&lt;</span>volume_name<span class="token operator">></span></code></pre><li><p><code>restart: always</code> (auto start container after logging in), <code>no</code> (default), <code>on-failure</code>.<li><p><code>build: &lt;dir_to_Dockerfile_file></code>: build an image before using <code>docker-compose</code>.<li><p><code>runtime: nvidia</code>: if <code>docker-compose --version</code> higher than 2.3 and there is NVIDIA GPU on your computer (check more detail in <a href=/docker-gpu#using-docker-compose>this note</a>).</ul></div></div><p>ðŸ”… If there is no already built image, you can use a <code>Dockerfile</code> in the same place as <code>docker-compose.yml</code>. In <code>docker-compose.yml</code>, use<pre class=language-yaml><code class=language-yaml><span class="token atrule key">services</span><span class="token punctuation">:</span><br>	<span class="token atrule key">dataswati</span><span class="token punctuation">:</span><br>		<span class="token atrule key">build</span><span class="token punctuation">:</span> .</code></pre><p>Then run <code>docker-compose up --build</code>.<p>ðŸ”… Update to the newer version of <code>docker-compose</code>? Included in Docker Desktop (on Windows and MacOS), read <a href=https://stackoverflow.com/a/49839172/1323473>this SO</a> (Linux).<h2 id=errors tabindex=-1>Errors <a href=#errors class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><p><em>Docker can't connect to docker daemon`</em>.<pre class=language-bash><code class=language-bash><span class="token comment"># check if daemon is running?</span><br><span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">docker</span><br><br><span class="token comment"># run</span><br><span class="token function">sudo</span> /etc/init.d/docker start</code></pre><hr><p><code>sudo systemctl restart docker</code> meets <em>Job for docker.service failed because the control process exited with error code</em>.<ol><li>Try to remove failed <code>daemon.json</code> file in <code>/etc/docker/</code> (if the problem comes from here)<li>Try running either <code>sudo /etc/init.d/docker start</code> or <code>sudo service docker restart</code> (twice if needed).</ol><hr><p><em>perl: warning: Please check that your locale settings:</em> when using below in the Dockerfile,<pre class=language-bash><code class=language-bash>ENV <span class="token constant environment">LANG</span> en_US.UTF-8<br>ENV <span class="token constant environment">LANGUAGE</span> en_US:en<br>ENV <span class="token constant environment">LC_ALL</span> en_US.UTF-8<br><br><span class="token comment"># Replace them by</span><br>RUN <span class="token builtin class-name">echo</span> <span class="token string">"LC_ALL=en_US.UTF-8"</span> <span class="token operator">>></span> /etc/environment<br>RUN <span class="token builtin class-name">echo</span> <span class="token string">"en_US.UTF-8 UTF-8"</span> <span class="token operator">>></span> /etc/locale.gen<br>RUN <span class="token builtin class-name">echo</span> <span class="token string">"LANG=en_US.UTF-8"</span> <span class="token operator">></span> /etc/locale.conf<br>RUN locale-gen en_US.UTF-8</code></pre><hr><pre class=language-bash><code class=language-bash><span class="token comment"># On Windows + WSL2</span><br>The process cannot access the <span class="token function">file</span> <span class="token string">'ext4.vhdx'</span> because it is being used by another process.</code></pre><ol><li>Quit docker.<li>Open <strong>Task Manager</strong>, try to end the processes <strong>wsappx</strong> (all of them).<li>Reopen docker.</ol><h2 id=reference tabindex=-1>Reference <a href=#reference class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><strong>Play with Docker</strong> -- <a href=https://labs.play-with-docker.com/ >right on the web</a>.<li><strong>Yury Pitsishin</strong> -- <a href=https://goinbigdata.com/docker-run-vs-cmd-vs-entrypoint/ >Docker RUN vs CMD vs ENTRYPOINT</a>.</ul></div><script type=application/ld+json>{
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Docker 101",
        "image": [],
        "author": "Anh-Thi DINH",
        "url": "https://dinhanhthi.com/docker/",
        "mainEntityOfPage": "https://dinhanhthi.com/docker/",
        "datePublished": "14-04-2022",
        "dateModified": "2022-04-14",
        "description": "ðŸ‘‰ Note: Docker + GPUs ðŸ‘‰ Note: Wordpress Docker ðŸ‘‰ Note: Airflow + Kubernetes 101 ðŸ‘‰ Note: Tensorflow extra What and Why? Intuitive images..."
      }</script></article></main><footer><a href=/ target=_blank>Thi Â Â©Â  2022 </a>Â â€¢Â  <a href=/about-the-notes/ >About this site </a>Â â€¢Â  <a href=https://photos.app.goo.gl/9OVEkdTjmtRPg7vC3 target=_blank>My sketches </a>Â â€¢Â  <a href=https://goo.gl/photos/yQXdQws1LLS16x5v5 target=_blank>I cook </a>Â â€¢Â  <a href=/support-thi/ ><img alt="Support Thi" class=keep-original src=/img_src/icons/coffee.svg height=16 width=auto> Support Thi</a></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js></script><script src=/src/js/components/clipboard.min.js></script><script src="/src/js/main.min.js?hash=d3b51a19b7" async defer></script><a href=/support-thi/ class="floating-button tooltip" id=buy-me-a-coffee><img alt="Support Thi" class=keep-original src=/img_src/icons/coffee.svg> <span class=tooltiptext>Support Thi</span> </a><button class="floating-button tooltip" id=scroll-top-btn><img alt="Scroll to top" class=keep-original src=/img_src/to-top.webp> <span class=tooltiptext>Top</span></button>