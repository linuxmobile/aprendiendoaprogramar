<!doctype html><html domain=.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="" http-equiv=Content-Security-Policy><link href=/favicon.svg rel=icon type=image/svg+xml><meta content=#f9c412 name=theme-color><meta content=noindex name=robots><title>Mean Shift clustering | Note of Thi</title><meta content="Mean Shift clustering | Note of Thi" prefix=og:http://ogp.me/ns# property=og:title><meta content="What? Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of..." name=description><meta content="What? Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of..." prefix=og:http://ogp.me/ns# property=og:description><meta content=summary_large_image name=twitter:card><meta content=@dinhanhthi name=twitter:site><meta content=@dinhanhthi name=twitter:creator><meta content=https://dinhanhthi.com/img_src/cover.png prefix=og:http://ogp.me/ns# property=og:image><meta content=article prefix=og:http://ogp.me/ns# property=og:type><link href=https://dinhanhthi.com/mean-shift/ rel=canonical><meta content=https://dinhanhthi.com/mean-shift/ prefix=og:http://ogp.me/ns# property=og:url><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="ðŸ”¥ Anh-Thi DINH"><link href=/ rel=preconnect crossorigin><style>body {
      visibility: hidden;
      opacity: 0;
    }</style><noscript><style>body {
        visibility: visible;
        opacity: 1;
      }</style></noscript><script csp-hash>if (/Mac OS X/.test(navigator.userAgent))
      document
        .documentElement
        .classList
        .add('apple')</script><link href=/src/css/main.css rel=stylesheet type=text/css><style>@font-face{font-display:swap;font-family:'fontello';src:url(/fontello/font/fontello.eot?46432155);src:url(/fontello/font/fontello.eot?46432155#iefix) format('embedded-opentype'),url(/fontello/font/fontello.woff2?46432155) format('woff2'),url(/fontello/font/fontello.woff?46432155) format('woff'),url(/fontello/font/fontello.ttf?46432155) format('truetype'),url(/fontello/font/fontello.svg?46432155#fontello) format('svg');font-weight:400;font-style:normal}[class*=" icon-"]:before,[class^=icon-]:before{font-family:"fontello";font-style:normal;font-weight:400;speak:never;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-doc:before{content:'\e800'}.icon-doc-add:before{content:'\e801'}.icon-stats:before{content:'\e802'}.icon-tags:before{content:'\e803'}.icon-like:before{content:'\e804'}.icon-cog-alt:before{content:'\e805'}.icon-project:before{content:'\e806'}.icon-mooc:before{content:'\e807'}.icon-dl:before{content:'\e808'}.icon-ml:before{content:'\e809'}.icon-python:before{content:'\e80a'}.icon-nlp:before{content:'\e80b'}.icon-r-lang:before{content:'\e80c'}.icon-skill:before{content:'\e80d'}.icon-js-solid:before{content:'\e80e'}.icon-game:before{content:'\e80f'}.icon-web:before{content:'\e810'}.icon-algo:before{content:'\e811'}.icon-mooc-solid:before{content:'\e812'}.icon-chatbot:before{content:'\e813'}.icon-web-dev:before{content:'\e814'}.icon-data:before{content:'\e815'}.icon-skill-solid:before{content:'\e816'}.icon-python-solid:before{content:'\e817'}.icon-project-solid:before{content:'\e818'}.icon-js:before{content:'\e819'}.icon-rocket:before{content:'\e81a'}.icon-ml-solid:before{content:'\e81b'}.icon-game-solid:before{content:'\e81c'}.icon-dl-solid:before{content:'\e81d'}.icon-nlp-solid:before{content:'\e81e'}.icon-web-solid:before{content:'\e81f'}.icon-algo-solid:before{content:'\e820'}.icon-puzzle-outline:before{content:'\e821'}.icon-ng:before{content:'\e822'}.icon-ok:before{content:'\e823'}.icon-link:before{content:'\e824'}.icon-down-circle:before{content:'\e826'}.icon-api:before{content:'\e828'}.icon-right-circle:before{content:'\e829'}.icon-down-open:before{content:'\e82a'}.icon-right-open:before{content:'\e82b'}.icon-copy:before{content:'\f0c5'}.icon-gamepad:before{content:'\f11b'}.icon-fork:before{content:'\f126'}.icon-mlops-solid:before{content:'\f135'}.icon-edu-solid:before{content:'\f19d'}.icon-others-solid:before{content:'\f1b3'}.icon-ds-solid:before{content:'\f1c0'}.icon-chart-area:before{content:'\f1fe'}.icon-chart-pie:before{content:'\f200'}.icon-ts:before{content:'\f201'}.icon-clone:before{content:'\f24d'}</style><body><script>function showTheme() {
        const btn = document.getElementById("toggle-dark-light");
        let toggleIcon = btn.firstElementChild;
        const currentTheme = localStorage.getItem("theme");
        if (currentTheme === "dark") {
          document
            .body
            .classList
            .toggle("dark-theme");
          toggleIcon.src = "/img_src/nav/sun.svg";
        } else if (currentTheme === "light") {
          document
            .body
            .classList
            .toggle("light-theme");
          toggleIcon.src = "/img_src/nav/moon.svg";
        }
      }
      function showContent() {
        document.body.style.visibility = 'visible';
        document.body.style.opacity = 1;
      }
      window.addEventListener('DOMContentLoaded', (event) => {
        showTheme();
        showContent();
      });</script><header class="wave-border wave-border-post"><nav><div id=nav><a href=/ class="nav-item no-effect"><img alt=home src=/img_src/nav/home.svg class=keep-original height=18 width=18> <span>Thi</span> </a><a href=/about/ class="nav-item no-effect"><img alt=about src=/img_src/nav/about.svg class=keep-original height=15 width=15> <span>About</span></a><div class=nav-search id=nav-search><form><input aria-label='search notes (press "/" to focus & "ESC" to lose)' autocomplete=off class=nav-search__input id=nav-search__input onfocusin=inFocus(this) placeholder='search notes (press "/" to focus & "ESC" to lose)' type=search></form><div id=nav-search__result-container style="display: none;"><ul id=nav-search__ul></ul><div id=nav-search__no-result style="display: none;"><p>No results found.</div></div></div><span class="nav-item no-effect nav-dark-light" href="" id=toggle-dark-light><img alt=light-mode src=/img_src/nav/moon.svg class=keep-original height=20 width=20> </span><a href=https://github.com/dinhanhthi class="nav-item no-effect nav-github" target=_blank><img alt=github src=/img_src/nav/github.svg class=keep-original height=20 width=20></a></div><div class=reading-progress-container><div id=reading-progress aria-hidden=true></div></div></nav><script>var divNavSearch=document.getElementById("nav-search"),divRes=document.getElementById("nav-search__result-container"),ulRes=document.getElementById("nav-search__ul");function inFocus(e){""!=e.value&&(divRes.style.display="block")}var isOnDiv=!1;divRes.addEventListener("mouseover",(function(){isOnDiv=!0})),divRes.addEventListener("mouseout",(function(){isOnDiv=!1}));var inputSearch=document.getElementById("nav-search__input");window.addEventListener("click",(function(){ulRes.getElementsByTagName("li").length>=1&&isOnDiv||(divRes.style.display="none")})),inputSearch.addEventListener("click",(e=>{e.stopPropagation()}));const addSelected=e=>{ulRes.querySelectorAll("li").forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected")};var isInView=(e,t)=>{var n=e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight;return e.offsetTop<t.scrollTop?"above":n?"below":"in"};const updateScroll=(e,t)=>{e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight&&(t.scrollTop=e.offsetTop+e.offsetHeight-t.offsetHeight),e.offsetTop<t.scrollTop&&(t.scrollTop=e.offsetTop)};document.onkeydown=e=>{checkInInput=document.activeElement==inputSearch,"/"!==e.key||checkInInput||(e.stopPropagation(),e.preventDefault(),inputSearch.focus())},document.addEventListener("focusin",(e=>{divNavSearch.contains(e.target)||(divRes.style.display="none")})),inputSearch.onkeydown=e=>{if("Enter"===e.key){e.stopPropagation(),e.preventDefault();var t=ulRes.querySelector('li[class*="selected"]');window.location.href=t.getElementsByClassName("item__content")[0].firstChild.firstChild.href}"Escape"===e.key&&(divRes.style.display="none",inputSearch.blur())},divNavSearch.onkeydown=e=>{if(hasResult=ulRes.getElementsByTagName("li").length>=1,hasResult){["ArrowUp","ArrowDown"].indexOf(e.key)>-1&&e.preventDefault();var t=ulRes.firstChild,n=ulRes.lastChild,s=ulRes.querySelector('li[class*="selected"]');switch(e.key){case"ArrowUp":nextLi=s&&s!=t?s.previousSibling:n,addSelected(nextLi),s=nextLi,updateScroll(s,divRes);break;case"ArrowDown":nextLi=s&&s!=n?s.nextSibling:t,addSelected(nextLi),s=nextLi,updateScroll(s,divRes)}}};</script><div class=header-container><div class="header-logo post-layout"><img alt="Mean Shift clustering" src=/img/header/clustering.png class=keep-original height=55 width=55></div><h1>Mean Shift clustering <sup class=draft-badge>draft</sup></h1><div id=more-info><div id=note-tag><a href=/tags/machine-learning/ id=category }>Machine Learning</a> <a href=/tags/clustering/ id=category }>Clustering</a></div><div id=last-modified>Last modified 2 years ago / <a href=https://github.com/dinhanhthi/notes/edit/master/./posts/ml/2020-03-28-mean-shift.md>Edit on Github</a></div></div></div></header><main class="" id=main-wrapper><article class=post-container><div class="container mt-2 normal page-note"><div class="not-full-warning danger"><div class=warning-icon><img alt=Warning src=/img_src/icons/time.svg class=keep-original></div><div>This post was <strong>updated more than 1 year ago</strong>, some information may be outdated!</div></div><div class="not-full-warning warning"><div class=warning-icon><img alt=Warning src=/img_src/icons/warning.svg class=keep-original></div><div>This is a draft, the content is not complete and of poor quality!</div></div><div class="toc toc-common toc-js"><div class=ol-container><div class=toc-heading>In this note</div><ol><li><a href=#what%3F>What?</a><li><a href=#when%3F>When?</a><li><a href=#pros-%26-cons>Pros & Cons</a><li><a href=#code%3F>Code?</a><li><a href=#usage-example>Usage example</a><li><a href=#references>References</a></ol></div></div><h2 id=what%3F tabindex=-1>What? <a href=#what%3F class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><p>Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of data points in the region, in the context of the Meanshift)<li><p>Non-Parametric Density Estimation.<li><p>The data points are sampled from an underlying PDF (Probability density function)<sup><a href=http://www.cse.psu.edu/~rtc12/CSE598G/introMeanShift_6pp.pdf target=_blank rel="noopener noreferrer">[ref]</a></sup>.<p><img alt="Data point density implies PDF" src=/img/post/ML/clustering/mean-shift-1.jpg class=img-full-70><br><em>Data point density implies PDF.</em><li><p>Mean-shift built based on the idea of <em>Kernel Density Estimation</em>.<li><p>Mean shift exploits this KDE idea by imagining what the points would do if they all climbed up hill to the nearest peak on the KDE surface. It does so by iteratively shifting each point uphill until it reaches a peak<sup><a href=https://spin.atomicobject.com/2015/05/26/mean-shift-clustering/ target=_blank rel="noopener noreferrer">[ref]</a></sup>.<div class=columns-2 markdown=1><p><img alt="Points climb to the nearest hill." src=/img/post/ML/clustering/mean-shift-2.gif><br><em>Points climb to the nearest hill.</em><p><img alt="Points climb to the nearest hill." src=/img/post/ML/clustering/mean-shift-3.gif><br><em>Points climb to the nearest hill.</em></div></ul><h2 id=when%3F tabindex=-1>When? <a href=#when%3F class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li>Image processing and computer vision.<li>Image Segmentation Application<sup><a href=https://spin.atomicobject.com/2015/05/26/mean-shift-clustering/ target=_blank rel="noopener noreferrer">[ref]</a></sup>.</ul><h2 id=pros-%26-cons tabindex=-1>Pros & Cons <a href=#pros-%26-cons class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><strong>Pros</strong>: Non-Parametric Density Estimation.<li><strong>Cons</strong>: It's computationally expensive O(nÂ²) <sup><a href=https://www.geeksforgeeks.org/ml-mean-shift-clustering/ target=_blank rel="noopener noreferrer">[ref]</a></sup>.</ul><h2 id=code%3F tabindex=-1>Code? <a href=#code%3F class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><pre class=language-python><code class=language-python><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> MeanShift<br>clustering <span class="token operator">=</span> MeanShift<span class="token punctuation">(</span>bandwidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span></code></pre><div class=flex-auto-equal-2 markdown=1><pre class=language-python><code class=language-python>clustering<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span><br>clustering<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span></code></pre><pre class=language-python><code class=language-python><span class="token comment"># or</span><br>clustering<span class="token punctuation">.</span>fit_predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span></code></pre></div><p>Components:<ul><li><code>clustering.labels_</code>: clusters' labels.</ul><h2 id=usage-example tabindex=-1>Usage example <a href=#usage-example class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li>Used to <a href=/time-series-tips#find-the-windows-of-time-series>determined windows of time</a> in time series data.</ul><h2 id=references tabindex=-1>References <a href=#references class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><strong>Saravanan Thirumuruganathan</strong> -- <a href=https://saravananthirumuruganathan.wordpress.com/2010/04/01/introduction-to-mean-shift-algorithm/ >Introduction To Mean Shift Algorithm</a>.<li><strong>Geeksforgeeks</strong> -- <a href=https://www.geeksforgeeks.org/ml-mean-shift-clustering/ >Mean-Shift clustering</a>.<li><strong>R.Collins</strong> -- <a href=http://www.cse.psu.edu/~rtc12/CSE598G/introMeanShift_6pp.pdf>Mean-Shift tracking</a>.<li><strong>Matt Nedrich</strong> -- <a href=https://spin.atomicobject.com/2015/05/26/mean-shift-clustering/ >Mean Shift Clustering</a>.</ul></div><script type=application/ld+json>{
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Mean Shift clustering",
        "image": [],
        "author": "Anh-Thi DINH",
        "url": "https://dinhanhthi.com/mean-shift/",
        "mainEntityOfPage": "https://dinhanhthi.com/mean-shift/",
        "datePublished": "28-03-2020",
        "dateModified": "2020-03-28",
        "description": "What? Mean-Shift assigns the data points to the clusters iteratively by shifting points towards the mode (mode is the highest density of..."
      }</script></article></main><footer><a href=/ target=_blank>Thi Â Â©Â  2022 </a>Â â€¢Â  <a href=/about-the-notes/ >About this site </a>Â â€¢Â  <a href=https://photos.app.goo.gl/9OVEkdTjmtRPg7vC3 target=_blank>My sketches </a>Â â€¢Â  <a href=https://goo.gl/photos/yQXdQws1LLS16x5v5 target=_blank>I cook </a>Â â€¢Â  <a href=/support-thi/ ><img alt="Support Thi" src=/img_src/icons/coffee.svg class=keep-original height=16 width=auto> Support Thi</a></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js></script><script src=/src/js/components/clipboard.min.js></script><script src="/src/js/main.min.js?hash=d3b51a19b7" async defer></script><a href=/support-thi/ class="floating-button tooltip" id=buy-me-a-coffee><img alt="Support Thi" src=/img_src/icons/coffee.svg class=keep-original> <span class=tooltiptext>Support Thi</span> </a><button class="floating-button tooltip" id=scroll-top-btn><img alt="Scroll to top" src=/img_src/to-top.webp class=keep-original> <span class=tooltiptext>Top</span></button>