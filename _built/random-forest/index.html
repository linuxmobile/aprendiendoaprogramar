<!doctype html><html domain=.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="" http-equiv=Content-Security-Policy><link href=/favicon.svg rel=icon type=image/svg+xml><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>Random Forest | Note of Thi</title><meta content="Random Forest | Note of Thi" prefix=og:http://ogp.me/ns# property=og:title><meta content="What's the idea of Random Forest? Random forest consists a (large) number of decision trees operating together (ensemble learning). The..." name=description><meta content="What's the idea of Random Forest? Random forest consists a (large) number of decision trees operating together (ensemble learning). The..." prefix=og:http://ogp.me/ns# property=og:description><meta content=summary_large_image name=twitter:card><meta content=@dinhanhthi name=twitter:site><meta content=@dinhanhthi name=twitter:creator><meta content=https://dinhanhthi.com/img_src/cover.png prefix=og:http://ogp.me/ns# property=og:image><meta content=article prefix=og:http://ogp.me/ns# property=og:type><link href=https://dinhanhthi.com/random-forest/ rel=canonical><meta content=https://dinhanhthi.com/random-forest/ prefix=og:http://ogp.me/ns# property=og:url><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="üî• Anh-Thi DINH"><link href=/ rel=preconnect crossorigin><link href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET><script src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js defer crossorigin=anonymous integrity=sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js defer crossorigin=anonymous integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl onload=renderMathInElement(document.body);></script><style>body {
      visibility: hidden;
      opacity: 0;
    }</style><noscript><style>body {
        visibility: visible;
        opacity: 1;
      }</style></noscript><script csp-hash>if (/Mac OS X/.test(navigator.userAgent))
      document
        .documentElement
        .classList
        .add('apple')</script><link href=/src/css/main.css rel=stylesheet type=text/css><style>@font-face{font-display:swap;font-family:'fontello';src:url(/fontello/font/fontello.eot?46432155);src:url(/fontello/font/fontello.eot?46432155#iefix) format('embedded-opentype'),url(/fontello/font/fontello.woff2?46432155) format('woff2'),url(/fontello/font/fontello.woff?46432155) format('woff'),url(/fontello/font/fontello.ttf?46432155) format('truetype'),url(/fontello/font/fontello.svg?46432155#fontello) format('svg');font-weight:400;font-style:normal}[class*=" icon-"]:before,[class^=icon-]:before{font-family:"fontello";font-style:normal;font-weight:400;speak:never;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-doc:before{content:'\e800'}.icon-doc-add:before{content:'\e801'}.icon-stats:before{content:'\e802'}.icon-tags:before{content:'\e803'}.icon-like:before{content:'\e804'}.icon-cog-alt:before{content:'\e805'}.icon-project:before{content:'\e806'}.icon-mooc:before{content:'\e807'}.icon-dl:before{content:'\e808'}.icon-ml:before{content:'\e809'}.icon-python:before{content:'\e80a'}.icon-nlp:before{content:'\e80b'}.icon-r-lang:before{content:'\e80c'}.icon-skill:before{content:'\e80d'}.icon-js-solid:before{content:'\e80e'}.icon-game:before{content:'\e80f'}.icon-web:before{content:'\e810'}.icon-algo:before{content:'\e811'}.icon-mooc-solid:before{content:'\e812'}.icon-chatbot:before{content:'\e813'}.icon-web-dev:before{content:'\e814'}.icon-data:before{content:'\e815'}.icon-skill-solid:before{content:'\e816'}.icon-python-solid:before{content:'\e817'}.icon-project-solid:before{content:'\e818'}.icon-js:before{content:'\e819'}.icon-rocket:before{content:'\e81a'}.icon-ml-solid:before{content:'\e81b'}.icon-game-solid:before{content:'\e81c'}.icon-dl-solid:before{content:'\e81d'}.icon-nlp-solid:before{content:'\e81e'}.icon-web-solid:before{content:'\e81f'}.icon-algo-solid:before{content:'\e820'}.icon-puzzle-outline:before{content:'\e821'}.icon-ng:before{content:'\e822'}.icon-ok:before{content:'\e823'}.icon-link:before{content:'\e824'}.icon-down-circle:before{content:'\e826'}.icon-api:before{content:'\e828'}.icon-right-circle:before{content:'\e829'}.icon-down-open:before{content:'\e82a'}.icon-right-open:before{content:'\e82b'}.icon-copy:before{content:'\f0c5'}.icon-gamepad:before{content:'\f11b'}.icon-fork:before{content:'\f126'}.icon-mlops-solid:before{content:'\f135'}.icon-edu-solid:before{content:'\f19d'}.icon-others-solid:before{content:'\f1b3'}.icon-ds-solid:before{content:'\f1c0'}.icon-chart-area:before{content:'\f1fe'}.icon-chart-pie:before{content:'\f200'}.icon-ts:before{content:'\f201'}.icon-clone:before{content:'\f24d'}</style><body><script>function showTheme() {
        const btn = document.getElementById("toggle-dark-light");
        let toggleIcon = btn.firstElementChild;
        const currentTheme = localStorage.getItem("theme");
        if (currentTheme === "dark") {
          document
            .body
            .classList
            .toggle("dark-theme");
          toggleIcon.src = "/img_src/nav/sun.svg";
        } else if (currentTheme === "light") {
          document
            .body
            .classList
            .toggle("light-theme");
          toggleIcon.src = "/img_src/nav/moon.svg";
        }
      }
      function showContent() {
        document.body.style.visibility = 'visible';
        document.body.style.opacity = 1;
      }
      window.addEventListener('DOMContentLoaded', (event) => {
        showTheme();
        showContent();
      });</script><header class="wave-border wave-border-post"><nav><div id=nav><a href=/ class="nav-item no-effect"><img alt=home class=keep-original src=/img_src/nav/home.svg height=18 width=18> <span>Thi</span> </a><a href=/about/ class="nav-item no-effect"><img alt=about class=keep-original src=/img_src/nav/about.svg height=15 width=15> <span>About</span></a><div class=nav-search id=nav-search><form><input aria-label='search notes (press "/" to focus & "ESC" to lose)' autocomplete=off class=nav-search__input id=nav-search__input onfocusin=inFocus(this) placeholder='search notes (press "/" to focus & "ESC" to lose)' type=search></form><div id=nav-search__result-container style="display: none;"><ul id=nav-search__ul></ul><div id=nav-search__no-result style="display: none;"><p>No results found.</div></div></div><span class="nav-item no-effect nav-dark-light" href="" id=toggle-dark-light><img alt=light-mode class=keep-original src=/img_src/nav/moon.svg height=20 width=20> </span><a href=https://github.com/dinhanhthi class="nav-item no-effect nav-github" target=_blank><img alt=github class=keep-original src=/img_src/nav/github.svg height=20 width=20></a></div><div class=reading-progress-container><div id=reading-progress aria-hidden=true></div></div></nav><script>var divNavSearch=document.getElementById("nav-search"),divRes=document.getElementById("nav-search__result-container"),ulRes=document.getElementById("nav-search__ul");function inFocus(e){""!=e.value&&(divRes.style.display="block")}var isOnDiv=!1;divRes.addEventListener("mouseover",(function(){isOnDiv=!0})),divRes.addEventListener("mouseout",(function(){isOnDiv=!1}));var inputSearch=document.getElementById("nav-search__input");window.addEventListener("click",(function(){ulRes.getElementsByTagName("li").length>=1&&isOnDiv||(divRes.style.display="none")})),inputSearch.addEventListener("click",(e=>{e.stopPropagation()}));const addSelected=e=>{ulRes.querySelectorAll("li").forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected")};var isInView=(e,t)=>{var n=e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight;return e.offsetTop<t.scrollTop?"above":n?"below":"in"};const updateScroll=(e,t)=>{e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetHeight&&(t.scrollTop=e.offsetTop+e.offsetHeight-t.offsetHeight),e.offsetTop<t.scrollTop&&(t.scrollTop=e.offsetTop)};document.onkeydown=e=>{checkInInput=document.activeElement==inputSearch,"/"!==e.key||checkInInput||(e.stopPropagation(),e.preventDefault(),inputSearch.focus())},document.addEventListener("focusin",(e=>{divNavSearch.contains(e.target)||(divRes.style.display="none")})),inputSearch.onkeydown=e=>{if("Enter"===e.key){e.stopPropagation(),e.preventDefault();var t=ulRes.querySelector('li[class*="selected"]');window.location.href=t.getElementsByClassName("item__content")[0].firstChild.firstChild.href}"Escape"===e.key&&(divRes.style.display="none",inputSearch.blur())},divNavSearch.onkeydown=e=>{if(hasResult=ulRes.getElementsByTagName("li").length>=1,hasResult){["ArrowUp","ArrowDown"].indexOf(e.key)>-1&&e.preventDefault();var t=ulRes.firstChild,n=ulRes.lastChild,s=ulRes.querySelector('li[class*="selected"]');switch(e.key){case"ArrowUp":nextLi=s&&s!=t?s.previousSibling:n,addSelected(nextLi),s=nextLi,updateScroll(s,divRes);break;case"ArrowDown":nextLi=s&&s!=n?s.nextSibling:t,addSelected(nextLi),s=nextLi,updateScroll(s,divRes)}}};</script><div class=header-container><div class="header-logo post-layout"><img alt="Random Forest" class=keep-original src=/img/header/decision-tree.svg height=55 width=55></div><h1>Random Forest</h1><div id=more-info><div id=note-tag><a href=/tags/machine-learning/ id=category }>Machine Learning</a></div><div id=last-modified>Last modified 2 years ago / <a href=https://github.com/dinhanhthi/notes/edit/master/./posts/ml/2019-09-03-random-forest.md>Edit on Github</a></div></div></div></header><main class="" id=main-wrapper><article class=post-container><div class="container mt-2 normal page-note"><div class="danger not-full-warning"><div class=warning-icon><img alt=Warning class=keep-original src=/img_src/icons/time.svg></div><div>This post was <strong>updated more than 1 year ago</strong>, some information may be outdated!</div></div><div class="toc toc-common toc-js"><div class=ol-container><div class=toc-heading>In this note</div><ol><li><a href="#what's-the-idea-of-random-forest%3F">What's the idea of Random Forest?</a><li><a href=#when-we-use-random-forest%3F>When we use Random Forest?</a><li><a href=#using-rf-with-scikit-learn>Using RF with Scikit-learn</a><ol><li><a href=#random-forest-classifier>Random forest classifier</a><li><a href=#random-forest-regression>Random forest regression</a><li><a href=#select-important-features-in-random-forest>Select important features in Random Forest</a></ol><li><a href=#references>References</a></ol></div></div><h2 id="what's-the-idea-of-random-forest%3F" tabindex=-1>What's the idea of Random Forest? <a href="#what's-the-idea-of-random-forest%3F" class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><p>Random forest consists a (large) number of <a href="/search?q=decision+tree">decision trees</a> operating together (<a href=https://en.wikipedia.org/wiki/Ensemble_learning>ensemble learning</a>). <mark>The class with the most votes</mark> from the trees will be chosen as the final result of the RF's prediction. These decision tree models are relatively uncorrelated so that they can protect each other from their individual errors.<p><img alt="An illustration of the random forest's idea." class=img-full-85 src=/img/post/ML/random-forest-decision-tree/rf1.jpg><br><em>An illustration of the random forest's idea.</em><div class=hsbox><div class=hs__title>What is <strong>Ensemble Learning</strong>?</div><div class=hs__content><p>Ensemble learning involves the <strong>combination of several models</strong> to solve a single prediction problem. It works by generating multiple classifiers/models which learn and make predictions independently. Those predictions are then combined into a single (mega) prediction that should be as good or better than the prediction made by any one classifer.<sup><a href=http://blog.yhat.com/posts/random-forests-in-python.html target=_blank rel="noopener noreferrer">[ref]</a></sup></div></div><p>‚ùì <strong>How (decision) trees are chosen?</strong> RF ensures that the chosen trees are not too correlated to the others.<ol><li><strong>Bagging</strong>: From a sample of size N, trees are chosen so that they also have size N <strong>with replacement</strong>. For example, if our training data was [1, 2, 3, 4, 5] (size 5), then we might give one of our tree the list [1, 2, 2, 5, 5] (with replacement).<li><strong>Feature randomness</strong>: The features in the original dataset are chosen randomly. There may be some trees that are lacking in some features.</ol><p>So in our random forest, we end up with trees that are not only trained on different sets of data (thanks to bagging) but also use different features to make decisions<sup><a href=https://towardsdatascience.com/understanding-random-forest-58381e0602d2 target=_blank rel="noopener noreferrer">[ref]</a></sup>.<p><em>For each tree</em>, we can use <a href=/decision-tree-classifier>decision tree classifier</a> or <a href=/decision-tree-regression>decision tree regression</a> depending on the type our problem (classification or regression).<h2 id=when-we-use-random-forest%3F tabindex=-1>When we use Random Forest? <a href=#when-we-use-random-forest%3F class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><em>Decision tree algorithms</em> easily lead to <mark><em>overfitting problems</em></mark>. Random forest algorithm can <mark>overcome</mark> this.<li>Capable of both regression and classification problems.<li>Handle a large number of features.<li>Estimating which features are important in the underlying data being modeled<sup><a href=http://blog.yhat.com/posts/random-forests-in-python.html target=_blank rel="noopener noreferrer">[ref]</a></sup>.<li>Random forest is capable of learning without carefully crafted data transformations<sup><a href=http://blog.yhat.com/posts/random-forests-in-python.html target=_blank rel="noopener noreferrer">[ref]</a></sup>.<li><mark>Output probabilities</mark> for classification problems.</ul><h2 id=using-rf-with-scikit-learn tabindex=-1>Using RF with Scikit-learn <a href=#using-rf-with-scikit-learn class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><h3 id=random-forest-classifier tabindex=-1>Random forest classifier <a href=#random-forest-classifier class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><p>Load the library,<pre class=language-python><code class=language-python><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier</code></pre><p>A sample dataset:<pre class=language-python><code class=language-python>iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># iris flowers</span><br>X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<br>y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target</code></pre><p>Create RF classifier(<a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html>other parameters</a>),<pre class=language-python><code class=language-python>clf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'entropy'</span><span class="token punctuation">,</span> <span class="token comment"># default is 'gini'</span><br>                             n_estimators<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment"># number of trees (default=10)</span><br>                             n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># number of processors being used ("-1" means "all")</span></code></pre><div class=success><p>If a problem has <strong>imbalanced classes</strong>, use <code>class_weight="balanced"</code>.<sup><a href=https://chrisalbon.com/machine_learning/trees_and_forests/handle_imbalanced_classes_in_random_forests/ >[ref]</a></sup></div><p>Training & predict (<a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html>other methods</a>),<pre class=language-python><code class=language-python>model <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><br>model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># returns: array([1])</span><br>model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># predict class probabilities</span></code></pre><h3 id=random-forest-regression tabindex=-1>Random forest regression <a href=#random-forest-regression class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><pre class=language-python><code class=language-python><span class="token comment"># load libraries</span><br><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor<br><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets</code></pre><pre class=language-python><code class=language-python><span class="token comment"># sample: Boston Housing Data</span><br>boston <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span><br>X <span class="token operator">=</span> boston<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><br>y <span class="token operator">=</span> boston<span class="token punctuation">.</span>target</code></pre><pre class=language-python><code class=language-python><span class="token comment"># train</span><br>regr <span class="token operator">=</span> RandomForestRegressor<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><br>model <span class="token operator">=</span> regr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span></code></pre><pre class=language-python><code class=language-python><span class="token comment"># predict</span><br>model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token operator">&lt;</span>something<span class="token operator">></span><span class="token punctuation">)</span></code></pre><h3 id=select-important-features-in-random-forest tabindex=-1>Select important features in Random Forest <a href=#select-important-features-in-random-forest class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h3><p>Some premilinaries,<pre class=language-python><code class=language-python><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier<br><br><span class="token comment"># Load data</span><br>iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><br>X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<br>y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target<br><br><span class="token comment"># create a RF classifier</span><br>clf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre><p>Select feature importance<sup><a href=https://chrisalbon.com/machine_learning/trees_and_forests/feature_importance target=_blank rel="noopener noreferrer">[ref]</a></sup>,<pre class=language-python><code class=language-python><span class="token comment"># Train model</span><br>model <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><br><br><span class="token comment"># Calculate feature importances</span><br>importances <span class="token operator">=</span> model<span class="token punctuation">.</span>feature_importances_<br><br><span class="token comment"># load additional packages</span><br><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<br><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</code></pre><p>Visualize,<div class=columns-2><pre class=language-python><code class=language-python><span class="token comment"># Sort feature importances in descending order</span><br>indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>importances<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><br><span class="token comment"># Rearrange feature names so they match the sorted feature importances</span><br>names <span class="token operator">=</span> <span class="token punctuation">[</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> indices<span class="token punctuation">]</span><br><br>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span><br>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Feature Importance"</span><span class="token punctuation">)</span><br>plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> importances<span class="token punctuation">[</span>indices<span class="token punctuation">]</span><span class="token punctuation">)</span><br>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> names<span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span><br><br>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img alt="Features importances." class="bg-white img-100" src=/img/post/ML/random-forest-decision-tree/feature_importance_11_0.png></div><p>Select features with importance greater than a threshold,<sup><a href=https://chrisalbon.com/machine_learning/trees_and_forests/select_important_features_in_random_forest target=_blank rel="noopener noreferrer">[ref]</a></sup><pre class=language-python><code class=language-python><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectFromModel<br><br><span class="token comment"># Create object that selects features with importance greater than or equal to a threshold</span><br>selector <span class="token operator">=</span> SelectFromModel<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><br><br><span class="token comment"># Feature new feature matrix using selector</span><br>X_important <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><br><br><span class="token comment"># Train random forest using most important features</span><br>model <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_important<span class="token punctuation">,</span> y<span class="token punctuation">)</span></code></pre><h2 id=references tabindex=-1>References <a href=#references class=direct-link aria-hidden=true><i class="fontello-icon icon-link"></i></a></h2><ul><li><strong>Tony Yiu</strong> -- <a href=https://towardsdatascience.com/understanding-random-forest-58381e0602d2>Understanding Random Forest</a>.<li><strong>Scikit-learn</strong> -- <a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html>Random Forest CLassifier</a> official doc.<li><strong>Scikit-learn</strong> -- <a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html>Random Forest Regression</a> official doc.<li><strong>Chris Albon</strong> -- <a href=https://chrisalbon.com/machine_learning/trees_and_forests/titanic_competition_with_random_forest/ >Titanic Competition With Random Forest</a>.<li><strong>The Yhat Blog</strong> -- <a href=http://blog.yhat.com/posts/random-forests-in-python.html>Random Forests in Python</a>.<li><strong><a href=http://fast.ai>fast.ai</a></strong> -- <a href=http://course18.fast.ai/lessonsml1/lesson1.html>Introduction to Random Forest</a> and a solution to "<em>Bull Book for Bulldozers</em>" problem on Kaggle.</ul></div><script type=application/ld+json>{
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Random Forest",
        "image": [],
        "author": "Anh-Thi DINH",
        "url": "https://dinhanhthi.com/random-forest/",
        "mainEntityOfPage": "https://dinhanhthi.com/random-forest/",
        "datePublished": "01-03-2020",
        "dateModified": "2020-03-01",
        "description": "What&#39;s the idea of Random Forest? Random forest consists a (large) number of decision trees operating together (ensemble learning). The..."
      }</script></article></main><footer><a href=/ target=_blank>Thi ¬†¬©¬† 2022 </a>¬†‚Ä¢¬† <a href=/about-the-notes/ >About this site </a>¬†‚Ä¢¬† <a href=https://photos.app.goo.gl/9OVEkdTjmtRPg7vC3 target=_blank>My sketches </a>¬†‚Ä¢¬† <a href=https://goo.gl/photos/yQXdQws1LLS16x5v5 target=_blank>I cook </a>¬†‚Ä¢¬† <a href=/support-thi/ ><img alt="Support Thi" class=keep-original src=/img_src/icons/coffee.svg height=16 width=auto> Support Thi</a></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js></script><script src=/src/js/components/clipboard.min.js></script><script src="/src/js/main.min.js?hash=d3b51a19b7" defer async></script><a href=/support-thi/ class="floating-button tooltip" id=buy-me-a-coffee><img alt="Support Thi" class=keep-original src=/img_src/icons/coffee.svg> <span class=tooltiptext>Support Thi</span> </a><button class="floating-button tooltip" id=scroll-top-btn><img alt="Scroll to top" class=keep-original src=/img_src/to-top.webp> <span class=tooltiptext>Top</span></button>