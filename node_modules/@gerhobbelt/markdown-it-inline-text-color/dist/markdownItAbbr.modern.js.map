{"version":3,"file":"markdownItAbbr.modern.js","sources":["../index.js"],"sourcesContent":["// Process ~subscript~\n\nlet COLOR_OPEN_REGEX = /{color:(#?\\w+)}/;\nlet COLOR_CLOSE_REGEX = /{color}/;\nlet TOKEN_TYPE = 'color_text';\nlet MARKUP = '{color}';\n\nfunction getColor(attrs) {\n  if (!attrs || attrs.length < 1) { return null; }\n\n  for (let ii = 0; ii < attrs.length; ii++) {\n    let att = attrs[ii];\n    if (att && att.length > 1) {\n      if (att[0] === 'color') {\n        return att[1];\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction color(state, silent) {\n  let found,\n      content,\n      token,\n      startResult,\n      endResult,\n      result,\n      nesting = 1,\n      isOpen = true,\n      max = state.posMax,\n      start = state.pos;\n\n  if (state.src.charCodeAt(start) !== 0x7B/* ~ */) { return false; }\n  if (silent) { return false; } // don't run any pairs in validation mode\n\n  content = state.src.slice(start);\n  startResult = COLOR_OPEN_REGEX.exec(content);\n  endResult = COLOR_CLOSE_REGEX.exec(content);\n  if (!startResult && !endResult) { return false; }\n\n  if (startResult && endResult) {\n    if (startResult.index < endResult.index) {\n      result = startResult;\n    } else {\n      nesting = -1;\n      result = endResult;\n    }\n  } else if (startResult) {\n    result = startResult;\n  } else {\n    result = endResult;\n    nesting = -1;\n  }\n\n  isOpen = result.length === 2;\n  state.posMax = start + result[0].length;\n\n  token         = state.push(TOKEN_TYPE, 'span', nesting);\n  token.markup  = MARKUP;\n\n  if (isOpen) {\n    token.attrPush([ 'color', result[1] ]);\n  }\n\n  state.pos = state.posMax;\n  state.posMax = max;\n  return true;\n}\n\nfunction renderDefault(tokens, idx, _options, env, self) {\n  let token = tokens[idx];\n\n  let result = [ '<' ];\n\n  if (token.nesting === -1) {\n    result.push('/');\n  }\n\n  result.push('span');\n\n  if (token.nesting === 1) {\n    let color = getColor(token.attrs);\n\n    if (color) {\n      result.push(' style=\"color:', color, ';\"');\n    }\n  }\n  result.push('>');\n\n  return result.join('');\n}\n\nmodule.exports = function sub_plugin(md, name, options) {\n  options = options || {};\n\n  md.inline.ruler.after('emphasis', 'span', color);\n\n  md.renderer.rules[TOKEN_TYPE] = options.render || renderDefault;\n};\n"],"names":["COLOR_OPEN_REGEX","COLOR_CLOSE_REGEX","TOKEN_TYPE","MARKUP","getColor","attrs","length","ii","att","color","state","silent","content","token","startResult","endResult","result","nesting","isOpen","max","posMax","start","pos","src","charCodeAt","slice","exec","index","push","markup","attrPush","renderDefault","tokens","idx","_options","env","self","join","module","exports","sub_plugin","md","name","options","inline","ruler","after","renderer","rules","render"],"mappings":"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"}